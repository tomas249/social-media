(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"/6QR":function(t,e,n){"use strict";n.d(e,"a",(function(){return K}));var i=n("fXoL"),o=n("NloB"),s=n("Kszi"),c=n("rj1t"),r=n("yHma"),a=n("N3Xk"),l=n("ofXK");const d=["obj"],p=["wrapper"],b=["*"];let g=(()=>{class t{constructor(t,e){this.modalService=t,this.renderer=e,this.status=new i.n}set trigger(t){null!==t&&(t?this.checkDelay():this.closeTooltip())}ngOnInit(){}ngAfterViewInit(){this.obj.nativeElement.addEventListener("mouseenter",this.checkDelay.bind(this)),this.wrapper.nativeElement.addEventListener("mouseleave",this.closeTooltip.bind(this))}checkDelay(){this.objDim=this.obj.nativeElement.getBoundingClientRect();const t=(({width:t,height:e})=>({width:t,height:e}))(this.objDim);for(const e in t)this.renderer.setStyle(this.wrapper.nativeElement,e,t[e]+"px");this.renderer.setStyle(this.wrapper.nativeElement,"z-index",3),this.status.emit(!0),clearTimeout(this.time),this.time=setTimeout(()=>this.openTooltip(),1500)}openTooltip(){this.modalService.closeByType("tooltip"),this.modalService.open({type:"tooltip",content:[{module:"Profile",component:"ProfileCard",params:this.params}],params:{objDimensions:this.objDim},keepOpened:!0},{action:"set",stack:["@"+this.params.user.username]},t=>{this.status.emit(t)})}closeTooltip(){this.renderer.setStyle(this.wrapper.nativeElement,"z-index",-1),this.status.emit(!1),clearTimeout(this.time)}}return t.\u0275fac=function(e){return new(e||t)(i.Jb(s.a),i.Jb(i.D))},t.\u0275cmp=i.Db({type:t,selectors:[["tooltip-wrapper"]],contentQueries:function(t,e,n){var o;1&t&&i.Cb(n,d,!0),2&t&&i.jc(o=i.Xb())&&(e.obj=o.first)},viewQuery:function(t,e){var n;1&t&&i.yc(p,!0),2&t&&i.jc(n=i.Xb())&&(e.wrapper=n.first)},inputs:{params:"params",trigger:"trigger"},outputs:{status:"status"},ngContentSelectors:b,decls:3,vars:0,consts:[[1,"wrapper"],["wrapper",""]],template:function(t,e){1&t&&(i.ec(),i.dc(0),i.Kb(1,"div",0,1))},styles:[".wrapper[_ngcontent-%COMP%]{position:absolute;background-color:hsla(0,0%,100%,0);display:block;border-radius:50%;top:0;left:0;cursor:pointer;z-index:-1}"]}),t})();var u=n("6Kw5");const f=["avatarAnimation"];function h(t,e){1&t&&i.Kb(0,"div",16)}const m=function(t){return{user:t}};function v(t,e){if(1&t){const t=i.Pb();i.Mb(0),i.Ob(1,"tooltip-wrapper",18),i.Wb("status",(function(e){return i.nc(t),i.ac(3).checkTooltipStatus(e)})),i.Ob(2,"img",19,20),i.Wb("click",(function(){i.nc(t);const e=i.ac(3);return e.goToUser(e.post.owner._id)})),i.Nb(),i.Ob(4,"div",21,22),i.Wb("click",(function(){i.nc(t);const e=i.ac(3);return e.goToUser(e.post.owner._id)})),i.Nb(),i.Nb(),i.Lb()}if(2&t){const t=i.ac(3);i.zb(1),i.fc("params",i.hc(3,m,t.post.owner))("trigger",t.triggerTooltip),i.zb(1),i.fc("src",t.post.owner.avatar.fullPath,i.pc)}}function O(t,e){if(1&t&&(i.Mb(0),i.Kb(1,"img",23),i.Lb()),2&t){const t=i.ac(3);i.zb(1),i.fc("src",t.post.owner.avatar.fullPath,i.pc)}}function y(t,e){if(1&t&&(i.Ob(0,"div",17),i.sc(1,v,6,5,"ng-container",7),i.sc(2,O,2,1,"ng-container",7),i.Nb()),2&t){const t=i.ac(2);i.zb(1),i.fc("ngIf",t.config.showOpt),i.zb(1),i.fc("ngIf",!t.config.showOpt)}}function P(t,e){1&t&&(i.Ob(0,"div"),i.Kb(1,"img",24),i.Nb())}function x(t,e){if(1&t){const t=i.Pb();i.Ob(0,"div",25),i.Ob(1,"span",26),i.Wb("click",(function(){return i.nc(t),i.ac(2).onDelete()})),i.uc(2,"clear"),i.Nb(),i.Nb()}}function C(t,e){1&t&&(i.Ob(0,"span"),i.uc(1,"\xa0>\xa0"),i.Nb())}function M(t,e){if(1&t){const t=i.Pb();i.Ob(0,"div",29),i.Ob(1,"span",30),i.Wb("click",(function(){i.nc(t);const n=e.$implicit;return i.ac(3).goToUser(n)})),i.uc(2),i.Nb(),i.sc(3,C,2,0,"span",7),i.Nb()}if(2&t){const t=e.$implicit,n=e.index,o=i.ac(3);i.zb(2),i.vc(t),i.zb(1),i.fc("ngIf",n!==o.post.replyRef.length-1)}}function w(t,e){if(1&t&&(i.Ob(0,"div",27),i.Ob(1,"span"),i.uc(2,"Replying to\xa0"),i.Nb(),i.sc(3,M,4,2,"div",28),i.Nb()),2&t){const t=i.ac(2);i.zb(3),i.fc("ngForOf",t.post.replyRef)}}const k=function(t){return{"current-selected-media":t}};function I(t,e){if(1&t){const t=i.Pb();i.Mb(0),i.Ob(1,"button",34),i.Wb("click",(function(){i.nc(t);const n=e.index;return i.ac(4).post.media[0].selectedIndex=n+1})),i.uc(2),i.Nb(),i.Lb()}if(2&t){const t=e.index,n=i.ac(4);i.zb(1),i.fc("title","Change to image ".concat(t+1))("ngClass",i.hc(3,k,n.post.media[0].selectedIndex===t+1)),i.zb(1),i.vc(t+1)}}function _(t,e){if(1&t&&(i.Ob(0,"div"),i.sc(1,I,3,5,"ng-container",33),i.Nb()),2&t){const t=i.ac(3);i.zb(1),i.fc("ngForOf",t.post.media.slice(1))}}function N(t,e){if(1&t){const t=i.Pb();i.Ob(0,"div"),i.Ob(1,"div",31),i.sc(2,_,2,1,"div",7),i.Nb(),i.Ob(3,"img",32),i.Wb("click",(function(){i.nc(t);const e=i.ac(2);return e.openMedia(e.post.media[e.post.media[0].selectedIndex].fullPath)})),i.Nb(),i.Nb()}if(2&t){const t=i.ac(2);i.zb(2),i.fc("ngIf",t.post.media.length>2),i.zb(1),i.fc("src",t.post.media[t.post.media[0].selectedIndex].fullPath,i.pc)}}function z(t,e){if(1&t&&(i.Ob(0,"span"),i.uc(1),i.Nb()),2&t){const t=i.ac(4);i.zb(1),i.wc("\xa0(",t.replyingProgress,")")}}function S(t,e){if(1&t&&(i.Ob(0,"span",47),i.uc(1," ~ publishing "),i.sc(2,z,2,1,"span",7),i.Nb()),2&t){const t=i.ac(3);i.zb(2),i.fc("ngIf",0!==t.replyingProgress)}}function L(t,e){1&t&&(i.Ob(0,"span",48),i.uc(1,"\xa0~ published"),i.Nb())}function R(t,e){if(1&t){const t=i.Pb();i.Ob(0,"span",49),i.Wb("click",(function(){return i.nc(t),i.ac(3).onLike()})),i.uc(1,"favorite_border"),i.Nb()}}function j(t,e){if(1&t){const t=i.Pb();i.Ob(0,"span",50),i.Wb("click",(function(){return i.nc(t),i.ac(3).onLike()})),i.uc(1,"favorite"),i.Nb()}}function U(t,e){if(1&t){const t=i.Pb();i.Ob(0,"div",35),i.Ob(1,"div",36),i.Ob(2,"div",37),i.Ob(3,"span",38),i.Wb("click",(function(){return i.nc(t),i.ac(2).onReply()})),i.uc(4,"chat_bubble_outline"),i.Nb(),i.Nb(),i.Ob(5,"span",39),i.uc(6),i.sc(7,S,3,1,"span",40),i.sc(8,L,2,0,"span",41),i.Nb(),i.Nb(),i.Ob(9,"div",42),i.Ob(10,"div",37),i.sc(11,R,2,0,"span",43),i.sc(12,j,2,0,"span",44),i.Nb(),i.Ob(13,"span",39),i.uc(14),i.Nb(),i.Nb(),i.Ob(15,"div",36),i.Ob(16,"div",45),i.Ob(17,"span",46),i.Wb("click",(function(){return i.nc(t),i.ac(2).onShare()})),i.uc(18,"send"),i.Nb(),i.Nb(),i.Nb(),i.Nb()}if(2&t){const t=i.ac(2);i.zb(6),i.wc(" ",t.count.replies," "),i.zb(1),i.fc("ngIf",t.config.publishing),i.zb(1),i.fc("ngIf",t.config.replied),i.zb(3),i.fc("ngIf",!t.config.liked),i.zb(1),i.fc("ngIf",t.config.liked),i.zb(2),i.wc(" ",t.count.likes," ")}}const D=function(){return{filter:"blur(1.5px)"}};function F(t,e){if(1&t){const t=i.Pb();i.Ob(0,"article",1),i.Ob(1,"div",2),i.Wb("click",(function(){return i.nc(t),i.ac().openReplyPage()})),i.Nb(),i.Ob(2,"div",3),i.Ob(3,"div",4),i.sc(4,h,1,0,"div",5),i.sc(5,y,3,2,"div",6),i.sc(6,P,2,0,"div",7),i.Nb(),i.Ob(7,"div",8),i.Ob(8,"div",9),i.Ob(9,"span",10),i.Ob(10,"span"),i.Ob(11,"div"),i.Ob(12,"span",11),i.Wb("mouseenter",(function(){return i.nc(t),i.ac().onOpenUser()}))("mouseleave",(function(){return i.nc(t),i.ac().onCloseUser()}))("click",(function(){i.nc(t);const e=i.ac();return e.goToUser(e.post.owner._id)})),i.uc(13),i.Nb(),i.Ob(14,"span"),i.uc(15),i.bc(16,"dateAgo"),i.Nb(),i.Nb(),i.Nb(),i.Nb(),i.sc(17,x,3,0,"div",12),i.Nb(),i.sc(18,w,4,1,"div",13),i.Ob(19,"div",14),i.uc(20),i.Nb(),i.sc(21,N,4,2,"div",7),i.sc(22,U,19,6,"div",15),i.Nb(),i.Nb(),i.Nb()}if(2&t){const t=i.ac();i.fc("ngClass",t.config.openPage&&"select-hover")("ngStyle",t.config.loading&&i.gc(14,D)),i.zb(4),i.fc("ngIf",t.config.thread),i.zb(1),i.fc("ngIf",t.post.owner),i.zb(1),i.fc("ngIf",t.config.empty),i.zb(7),i.wc(" @",t.post.owner.username," "),i.zb(2),i.wc(" - ",i.cc(16,12,t.post.createdAt),""),i.zb(2),i.fc("ngIf",t.config.owner&&t.config.showOpt),i.zb(1),i.fc("ngIf",t.post.replyRef&&0!==t.post.replyRef.length),i.zb(2),i.wc(" ",t.post.text," "),i.zb(1),i.fc("ngIf",t.post.media&&0!==t.post.media.length),i.zb(1),i.fc("ngIf",t.config.showOpt)}}let K=(()=>{class t{constructor(t,e,n,i,o,s){this.postsService=t,this.modalService=e,this.token=n,this.locationService=i,this.navbarService=o,this.renderer=s,this.contextInfo={i:0,type:void 0},this.config={showOpt:!0,openPage:!0,owner:!1,replied:!1,publishing:!1,deleted:!1,liked:!1,shared:!1,reported:!1,thread:!1,tooltip:!0,loading:!1,empty:!1},this.count={replies:0,likes:0,shares:0},this.mediaSelIdx=0,this.replyingProgress=0,this.triggerTooltip=null,this.tooltipOpened=!1}set inputConfig(t){this.config=Object.assign(this.config,t),this._inputConfig=t}get inputConfig(){return this._inputConfig||{}}set post(t){if(t.media&&0!==t.media.length&&!t.media[0].selectedIndex&&t.media.unshift({selectedIndex:1}),this.config.empty)t._id="loading...",t.replyRef=Array(this.contextInfo.i).fill("???"),this._post=t;else if(t._id)this.countData(t),this._post=this.auth(t,this.token.getUserId()),this._post=Object.assign({},t);else{const e=this.token.getUserData();t.owner=(({id:t,name:e,username:n,avatar:i})=>({_id:t,name:e,username:n,avatar:i}))(e),this.config.owner=!0,this.config.loading=!0,this.config.thread=!1,this._post=t}}get post(){return this._post}ngOnInit(){}ngOnChanges(t){var e,n,i,o;const s=(null===(n=null===(e=t.post)||void 0===e?void 0:e.previousValue)||void 0===n?void 0:n._id)!==(null===(i=t.post)||void 0===i?void 0:i.currentValue._id);!(null===(o=t.post)||void 0===o?void 0:o.firstChange)&&s&&(this.config=Object.assign(this.config,this._inputConfig),this._post.media&&0!==this._post.media.length&&!this._post.media.selectedIndex&&this._post.media.unshift({selectedIndex:1}),this.config.replied=!1,this.config.deleted=!1)}countData(t){var e;this.count={replies:(null===(e=t.child)||void 0===e?void 0:e.length)||0,likes:t.likes,shares:0}}auth(t,e){return this.config.owner=t.owner._id===e&&(!this.inputConfig.hasOwnProperty("owner")||this.inputConfig.owner),this.config.liked=t.whoLiked.includes(e),e&&(t.confirm={owner:this.config.owner,liked:this.config.liked}),t}goToUser(t){this.config.showOpt&&this.navbarService.go("/u/"+t)}onReply(){this.checkAuth("In order to reply a post you need to be logged in")&&this.modalService.open({type:"default",content:[{module:"Posts",component:"PostPublish",params:{postReply:this.post,destinationConfig:this.publishConfig}}]},{action:"add",stack:["Reply"]},t=>{var e;t?t&&t.hasOwnProperty("progress")?this.replyingProgress=t.progress:(this.count.replies+=1,this.config.publishing=!1,this.config.replied=!0,this.replyingProgress=0,["list","reply"].includes(null===(e=this.contextInfo)||void 0===e?void 0:e.type)&&this.post.child.push(t)):(this.config.replied=!1,this.config.publishing=!0,this.locationService.removeItemFromStack(2),this.locationService.addItemToStack(["Publishing reply..."]))})}onLike(){this.checkAuth("In order to like a post you need to be logged in")&&(this.config.liked?(this.config.liked=!1,this.count.likes-=1):(this.config.liked=!0,this.count.likes+=1),this.postsService.likePost(this.post._id))}onDelete(){this.postsService.deletePost(this.post._id,this.deleteConfig)}openReplyPage(){this.config.openPage&&(this.modalService.forceClose(),this.postsService.setMainPost(Object.assign({},this.post),this.contextInfo),this.navbarService.go("/post/"+this.post._id))}onShare(){const t=`${window.location.host}/p/${this.post._id}`;this.modalService.open({type:"default",content:[{title:"Share a post"},{html:`<p align="center">${t}</p>`}]},{action:"add",stack:["Share"]})}onOpenUser(){!this.tooltipOpened&&this.config.showOpt&&(this.triggerTooltip=!0)}onCloseUser(){this.triggerTooltip=!1}checkTooltipStatus(t){this.tooltipOpened=t,t?this.avatarAnimation.nativeElement.className="loading-avatar":this.renderer.removeClass(this.avatarAnimation.nativeElement,"loading-avatar")}checkAuth(t){return!!this.token.isLogged()||(this.modalService.open({type:"default",content:[{title:t},{module:"Auth",component:"Login",params:{navigateEnd:!1}}]},{action:"add",stack:["Login"]}),!1)}openMedia(t){this.modalService.open({type:"extended",content:[{title:"Media from @"+this.post.owner.username},{html:`<img width="100%" src="${t}">`}]},{action:"add",stack:["Media"]})}}return t.\u0275fac=function(e){return new(e||t)(i.Jb(o.a),i.Jb(s.a),i.Jb(c.a),i.Jb(r.a),i.Jb(a.a),i.Jb(i.D))},t.\u0275cmp=i.Db({type:t,selectors:[["app-post"]],viewQuery:function(t,e){var n;1&t&&i.yc(f,!0),2&t&&i.jc(n=i.Xb())&&(e.avatarAnimation=n.first)},inputs:{contextInfo:"contextInfo",publishConfig:"publishConfig",deleteConfig:"deleteConfig",inputConfig:"inputConfig",post:"post"},features:[i.xb],decls:1,vars:1,consts:[[3,"ngClass","ngStyle",4,"ngIf"],[3,"ngClass","ngStyle"],[1,"route",3,"click"],[1,"post"],[1,"a-profile"],["class","thread-line",4,"ngIf"],["class","a-profile-avatar",4,"ngIf"],[4,"ngIf"],[1,"a-content"],[1,"a-acc"],[1,"a-username"],[1,"aroba",3,"mouseenter","mouseleave","click"],["class","delete-bttn","style","margin-left: auto",4,"ngIf"],["class","replyRef",4,"ngIf"],[1,"a-text"],["class","a-buttons noselect",4,"ngIf"],[1,"thread-line"],[1,"a-profile-avatar"],[3,"params","trigger","status"],[1,"a-avatar",3,"src","click"],["obj",""],[3,"click"],["avatarAnimation",""],[1,"a-avatar",3,"src"],[1,"a-avatar",2,"background-color","lightgray"],[1,"delete-bttn",2,"margin-left","auto"],["title","Delete post",1,"material-icons",3,"click"],[1,"replyRef"],["class","arobas",4,"ngFor","ngForOf"],[1,"arobas"],[1,"aroba",3,"click"],[1,"count-container"],["title","Click to open full screen",1,"selected-media",3,"src","click"],[4,"ngFor","ngForOf"],[1,"media-count",3,"title","ngClass","click"],[1,"a-buttons","noselect"],[1,"a-bttn-group"],[1,"a-bttn-icon-box"],["title","Reply",1,"material-icons","a-bttn-icon",3,"click"],[1,"a-bttn-count"],["class","notify","style","color: orange",4,"ngIf"],["class","primary notify",4,"ngIf"],[1,"a-bttn-group","noselect"],["title","Like","class","material-icons a-bttn-icon",3,"click",4,"ngIf"],["title","Dislike","class","material-icons a-bttn-icon red",3,"click",4,"ngIf"],[1,"a-bttn-icon-box","a-bttn-icon"],["title","Share",1,"material-icons","a-bttn-icon",3,"click"],[1,"notify",2,"color","orange"],[1,"primary","notify"],["title","Like",1,"material-icons","a-bttn-icon",3,"click"],["title","Dislike",1,"material-icons","a-bttn-icon","red",3,"click"]],template:function(t,e){1&t&&i.sc(0,F,23,15,"article",0),2&t&&i.fc("ngIf",e.post)},directives:[l.k,l.i,l.l,g,l.j],pipes:[u.a],styles:["article[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:relative;padding-bottom:.5rem}.select-hover[_ngcontent-%COMP%]:hover{background-color:#111d29}.route[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;cursor:pointer}.bar-container[_ngcontent-%COMP%]{margin:10px auto;width:80%;text-align:center}.progress[_ngcontent-%COMP%]{padding:3px;border-radius:12px;background:rgba(0,0,0,.25)}.progress-bar[_ngcontent-%COMP%]{height:.2rem;border-radius:30px;width:85%;background-color:rgba(71,239,99,.47)}.material-icons[_ngcontent-%COMP%]{cursor:pointer;position:relative}.replyRef[_ngcontent-%COMP%]{margin-bottom:.3rem;color:var(--secondary-color);font-size:.8rem}.notify[_ngcontent-%COMP%]{position:absolute}.arobas[_ngcontent-%COMP%]{display:inline-block}.aroba[_ngcontent-%COMP%]{color:#06b8ff;cursor:pointer;position:relative;z-index:1}.aroba[_ngcontent-%COMP%]:hover{color:var(--primary-color)}.post[_ngcontent-%COMP%]{padding:1rem 1rem 0}.a-acc[_ngcontent-%COMP%], .post[_ngcontent-%COMP%]{display:flex}.a-name[_ngcontent-%COMP%]{color:var(--text-color);font-weight:700;margin-right:.3rem}.a-name[_ngcontent-%COMP%], .a-username[_ngcontent-%COMP%]{font-size:1rem;cursor:pointer}.a-username[_ngcontent-%COMP%]{color:#8899a6}.a-profile[_ngcontent-%COMP%]{display:flex;flex-direction:column}.a-avatar[_ngcontent-%COMP%], .a-profile-avatar[_ngcontent-%COMP%]{position:relative}.a-avatar[_ngcontent-%COMP%]{width:3.4rem;height:3.4rem;border-radius:50%;background-color:var(--hover-color);padding:.2rem;cursor:pointer;z-index:1}.a-content[_ngcontent-%COMP%]{margin-left:.8rem;flex:1;display:flex;flex-direction:column}.a-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin:.3rem 0;flex:1}.a-bttn-group[_ngcontent-%COMP%]{width:100%;flex-direction:row;margin-right:auto;cursor:pointer}.a-bttn-group[_ngcontent-%COMP%], .a-bttn-icon-box[_ngcontent-%COMP%]{display:flex;align-items:center}.a-bttn-icon-box[_ngcontent-%COMP%]{padding:.7rem;border-radius:50%}.a-bttn-count[_ngcontent-%COMP%], .a-bttn-icon[_ngcontent-%COMP%]{color:var(--secondary-color);z-index:1}.a-bttn-icon-box[_ngcontent-%COMP%]:hover{background-color:var(--hover-empty-color)}.a-bttn-icon-box[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%], .a-bttn-icon-box[_ngcontent-%COMP%]:hover ~ .a-bttn-count[_ngcontent-%COMP%]{color:var(--primary-color)}.a-text[_ngcontent-%COMP%]{position:relative;display:flex;width:0}.comment[_ngcontent-%COMP%]{padding:1rem 1rem 0}.thread-line[_ngcontent-%COMP%]{border-left:3px solid #8899a6;margin-left:30px;height:100%;margin-top:2rem;position:absolute}.red[_ngcontent-%COMP%]{color:#ff6a6a;border:0}.selected-media[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:30px;position:relative;cursor:pointer;transition:transform .2s}.selected-media[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.media-count[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;padding:.5rem 1rem;border:0;border-radius:500px;text-align:center;display:inline;cursor:pointer;background-color:var(--primary-color);color:var(--text-color);margin-right:1rem;position:relative}.media-count[_ngcontent-%COMP%]:hover:not(.current-selected-media){background-color:var(--hover-solid-color)}.count-container[_ngcontent-%COMP%]{margin:1rem 0;display:flex;flex-direction:row;align-items:center}.current-selected-media[_ngcontent-%COMP%]{background-color:var(--hover-empty-color)}.delete-bttn[_ngcontent-%COMP%]{margin-left:auto;cursor:pointer}.loading-avatar[_ngcontent-%COMP%]{position:absolute;z-index:2;width:3.8rem;height:3.8rem;top:0;border-radius:50%;background-color:rgba(23,191,99,.589);-webkit-animation:example 1.5s linear .1s;animation:example 1.5s linear .1s;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}@-webkit-keyframes example{0%{width:3.8rem;height:3.8rem;left:0;top:0}to{width:0;height:0;left:1.9rem;top:1.9rem}}@keyframes example{0%{width:3.8rem;height:3.8rem;left:0;top:0}to{width:0;height:0;left:1.9rem;top:1.9rem}}"]}),t})()},"6Kw5":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n("fXoL");let o=(()=>{class t{transform(t,e){if(t){const e=Math.floor((+new Date-+new Date(t))/1e3);if(e<29)return"Just now";const n={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};let i;for(const t in n)if(i=Math.floor(e/n[t]),i>0)return 1===i?i+" "+t+" ago":i+" "+t+"s ago"}return t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=i.Ib({name:"dateAgo",type:t,pure:!0}),t})()},OUel:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var i=n("SxV6"),o=n("fXoL"),s=n("NloB"),c=n("ofXK"),r=n("/6QR");function a(t,e){1&t&&(o.Ob(0,"div",3),o.Ob(1,"h3"),o.uc(2,"Searching posts..."),o.Nb(),o.Nb())}const l=function(t){return{showOpt:t,openPage:!0}},d=function(t){return{i:t,type:"list"}},p=function(){return{destination:0}},b=function(t){return{destination:1,parentIndex:t}};function g(t,e){if(1&t&&(o.Ob(0,"div",7),o.Kb(1,"app-post",8),o.Nb()),2&t){const t=e.$implicit,n=e.index,i=o.ac(3);o.zb(1),o.fc("inputConfig",o.hc(5,l,i.showOptPosts))("contextInfo",o.hc(7,d,n))("publishConfig",o.gc(9,p))("deleteConfig",o.hc(10,b,n))("post",t)}}function u(t,e){if(1&t&&(o.Ob(0,"div"),o.sc(1,g,2,12,"div",6),o.Nb()),2&t){const t=o.ac().ngIf;o.zb(1),o.fc("ngForOf",t)}}function f(t,e){1&t&&(o.Ob(0,"div",3),o.Ob(1,"h3"),o.uc(2,"No posts published yet"),o.Nb(),o.Nb())}function h(t,e){if(1&t&&(o.Ob(0,"div",4),o.sc(1,u,2,1,"div",5),o.sc(2,f,3,0,"div",1),o.Nb()),2&t){const t=e.ngIf,n=o.ac();o.zb(1),o.fc("ngIf",!n.loading&&t&&0!==t.length),o.zb(1),o.fc("ngIf",!n.loading&&0===t.length)}}let m=(()=>{class t{constructor(t){this.postsService=t,this.showOptPosts=!0,this.loading=!0}set queryUrl(t){this.loading=!0,this.postsService.getPostsList(t).pipe(Object(i.a)()).subscribe(t=>{this.loading=!1,this.pageInfo={count:t.count,pagination:t.pagination}}),this._queryUrl=t}get queryUrl(){return this._queryUrl}ngOnInit(){this.postsList$=this.postsService.posts$}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(s.a))},t.\u0275cmp=o.Db({type:t,selectors:[["app-posts-list"]],inputs:{showOptPosts:"showOptPosts",queryUrl:"queryUrl"},decls:4,vars:4,consts:[[1,"container"],["style","padding: 2rem; text-align: center;",4,"ngIf"],["class","posts-list",4,"ngIf"],[2,"padding","2rem","text-align","center"],[1,"posts-list"],[4,"ngIf"],["class","border",4,"ngFor","ngForOf"],[1,"border"],[3,"inputConfig","contextInfo","publishConfig","deleteConfig","post"]],template:function(t,e){1&t&&(o.Ob(0,"div",0),o.sc(1,a,3,0,"div",1),o.sc(2,h,3,2,"div",2),o.bc(3,"async"),o.Nb()),2&t&&(o.zb(1),o.fc("ngIf",e.loading),o.zb(1),o.fc("ngIf",o.cc(3,2,e.postsList$)))},directives:[c.k,c.j,r.a],pipes:[c.b],styles:[".container[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column}.border[_ngcontent-%COMP%]{border-bottom:1.5px solid var(--primary-color)}.auth-container[_ngcontent-%COMP%]{padding:1rem;justify-content:center}.auth-container[_ngcontent-%COMP%], .notLogged[_ngcontent-%COMP%]{display:flex;align-items:center}.notLogged[_ngcontent-%COMP%]{flex-direction:column;margin:0 auto}.bttn[_ngcontent-%COMP%]{border:0;font-size:1.1rem;font-weight:700;padding:.6rem 3rem;border-radius:500px;text-align:center;display:inline;cursor:pointer;background-color:var(--primary-color)}.bttn[_ngcontent-%COMP%]:hover{background-color:#15ac59}.auth-text[_ngcontent-%COMP%]{font-size:1.3rem;padding-bottom:.5rem}"]}),t})()},iTUp:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n("fXoL");let o=(()=>{class t{}return t.\u0275mod=i.Hb({type:t}),t.\u0275inj=i.Gb({factory:function(e){return new(e||t)}}),t})()},xZLo:function(t,e,n){"use strict";n.r(e),n.d(e,"PostsModule",(function(){return dt}));var i=n("ofXK"),o=n("tyNb"),s=n("lJxs"),c=n("fXoL"),r=n("NloB"),a=n("yHma"),l=n("rj1t"),d=n("Kszi"),p=n("vkgz"),b=n("BFxc"),g=n("/6QR");const u=["postInput"],f=["mediaSelect"],h=function(){return{showOpt:!1,thread:!0,openPage:!1}};function m(t,e){if(1&t&&(c.Ob(0,"div",20),c.Kb(1,"app-post",21),c.Nb()),2&t){const t=c.ac();c.zb(1),c.fc("inputConfig",c.gc(2,h))("post",t.postReply)}}function v(t,e){if(1&t&&(c.Ob(0,"div",22),c.Ob(1,"span"),c.uc(2,"Replying to\xa0"),c.Nb(),c.Ob(3,"span",23),c.uc(4),c.Nb(),c.Nb()),2&t){const t=c.ac();c.zb(4),c.wc("@",t.postReply.owner.username,"")}}function O(t,e){if(1&t&&(c.Zb(),c.Yb(),c.Ob(0,"div",24),c.uc(1),c.Nb()),2&t){const t=c.ac();c.zb(1),c.wc(" Uploading ",t.uploadProgress,"% ")}}const y=function(t){return{"current-selected-media":t}};function P(t,e){if(1&t){const t=c.Pb();c.Mb(0),c.Ob(1,"button",30),c.Wb("click",(function(){c.nc(t);const n=e.index;return c.ac(3).selectedMediaIndex=n})),c.uc(2),c.Nb(),c.Lb()}if(2&t){const t=e.index,n=c.ac(3);c.zb(1),c.fc("ngClass",c.hc(2,y,n.selectedMediaIndex===t)),c.zb(1),c.vc(t+1)}}function x(t,e){if(1&t&&(c.Ob(0,"div"),c.sc(1,P,3,4,"ng-container",29),c.Nb()),2&t){const t=c.ac(2);c.zb(1),c.fc("ngForOf",t.selectedMediaBlob)}}function C(t,e){if(1&t&&(c.Ob(0,"div"),c.Kb(1,"img",31),c.Nb()),2&t){const t=c.ac(2);c.zb(1),c.fc("src",t.selectedMediaBlob[t.selectedMediaIndex].url,c.pc)}}function M(t,e){if(1&t&&(c.Ob(0,"div"),c.Ob(1,"span"),c.Ob(2,"i"),c.uc(3,"Video thumbnail"),c.Nb(),c.Nb(),c.Kb(4,"video",31),c.Nb()),2&t){const t=c.ac(2);c.zb(4),c.fc("src",t.selectedMediaBlob[t.selectedMediaIndex].url,c.pc)}}function w(t,e){if(1&t){const t=c.Pb();c.Ob(0,"div",25),c.Ob(1,"div",26),c.sc(2,x,2,1,"div",27),c.Ob(3,"div",28),c.Wb("click",(function(){c.nc(t);const e=c.ac();return e.onCancelSelectedMedia(e.selectedMediaIndex)})),c.uc(4),c.Nb(),c.Nb(),c.sc(5,C,2,1,"div",27),c.sc(6,M,5,1,"div",27),c.Nb()}if(2&t){const t=c.ac();c.zb(2),c.fc("ngIf",t.selectedMediaBlob.length>1),c.zb(2),c.wc("Remove media ",t.selectedMediaIndex+1,""),c.zb(1),c.fc("ngIf","image"===(null==t.selectedMediaBlob[t.selectedMediaIndex]?null:t.selectedMediaBlob[t.selectedMediaIndex].format)),c.zb(1),c.fc("ngIf","video"===(null==t.selectedMediaBlob[t.selectedMediaIndex]?null:t.selectedMediaBlob[t.selectedMediaIndex].format))}}let k=(()=>{class t{constructor(t,e,n){this.postsService=t,this.modalService=e,this.token=n,this.postReply=null,this.destinationConfig=null,this.selectedMedia=[],this.selectedMediaBlob=[],this.selectedMediaIndex=-1,this.showUploadProgress=!1,this.uploadProgress=0}ngOnInit(){this.user=this.token.getUserData()}publishPost(){const t=this.postInput.nativeElement.innerText;if(!t)return;this.modalService.emitResponse(!1,!1);const e={text:t,media:0!==this.selectedMedia.length?this.selectedMedia:null};this.publisher$=(()=>this.postReply?this.postsService.replyPost(this.postReply._id,e,this.destinationConfig):this.postsService.publishPost(e,this.destinationConfig))().subscribe(t=>{t.progress?(this.showUploadProgress=!0,this.uploadProgress=t.progress):this.showUploadProgress=!1,this.modalService.emitResponse(!t.hasOwnProperty("progress"),t)}),this.clear()}clear(){this.postInput.nativeElement.innerText="",this.mediaSelect.nativeElement.value="",this.selectedMedia=[],this.selectedMediaBlob=[],this.selectedMediaIndex=0}onMediaSelect(t){if(this.selectedMedia.length+t.target.files.length>5)this.modalService.open({type:"default",content:[{title:"Media error"},{html:"<p>You can only attach 5 media files per post!</p>"}]},{action:"add",stack:["Media","Error"]});else{for(const[e,n]of Object.entries(t.target.files)){const t=this.tempFilter(n);if(!t.valid)return void this.modalService.open({type:"default",content:[{title:"Media error"},{html:t.message},{html:"<p>Try with images or short videos!</p>"}]},{action:"add",stack:["Media","Error"]});this.selectedMedia.push(n),this.createFormData(n,e=>{this.selectedMediaBlob.push({format:t.format,url:e})})}this.selectedMediaIndex=this.selectedMedia.length-1}}onCancelSelectedMedia(t){this.selectedMedia.splice(t,1),this.selectedMediaBlob.splice(t,1),this.selectedMediaIndex>this.selectedMedia.length-1&&0!==this.selectedMedia.length&&(this.selectedMediaIndex-=1)}createFormData(t,e){const n=new FileReader;n.readAsDataURL(t),n.onload=t=>{this.mediaSelect.nativeElement.value="",e(n.result)}}tempFilter(t){let e={format:null,valid:null,message:null};const n=t.type.match(/(\w+)\/(\w+)?/);return e.format=n[1],"video"===e.format?(e.valid=!(t.size>15e6),e.message="Max size is 15MB"):"image"===e.format?e.valid=!0:(e.valid=!1,e.message=`'<strong>${n[2]}</strong>' is not a valid format.`),e}getGalleryUrl(){return this.showUploadProgress=!0,this.postsService.uploadGallery(this.selectedMedia).pipe(Object(p.a)(t=>{t.progress?(this.uploadProgress=t.progress,this.modalService.emitResponse(!1,{progress:t.progress}),console.log(this.uploadProgress)):t.completed&&(this.uploadProgress="Uploaded")}),Object(b.a)(1),Object(s.a)(t=>t))}test(){console.log(this.selectedMedia)}}return t.\u0275fac=function(e){return new(e||t)(c.Jb(r.a),c.Jb(d.a),c.Jb(l.a))},t.\u0275cmp=c.Db({type:t,selectors:[["app-post-publish"]],viewQuery:function(t,e){var n;1&t&&(c.yc(u,!0),c.yc(f,!0)),2&t&&(c.jc(n=c.Xb())&&(e.postInput=n.first),c.jc(n=c.Xb())&&(e.mediaSelect=n.first))},inputs:{postReply:"postReply",destinationConfig:"destinationConfig"},decls:22,vars:5,consts:[["class","toReply",4,"ngIf"],[1,"a-profile"],[3,"src"],[1,"a-content"],["class","replyRef upper",4,"ngIf"],["contenteditable","true","id","text-box","placeholder","What's happening?"],["postInput",""],[1,"a-buttons"],["type","file","multiple","",2,"display","none",3,"change"],["mediaSelect",""],[1,"bttn-opt"],[1,"icon-box",3,"click"],["width","1em","height","1em","viewBox","0 0 16 16","fill","currentColor","xmlns","http://www.w3.org/2000/svg",1,"bi","bi-image","opt-icon"],["fill-rule","evenodd","d","M14.002 2h-12a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1zm-12-1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12z"],["d","M10.648 7.646a.5.5 0 0 1 .577-.093L15.002 9.5V14h-14v-2l2.646-2.354a.5.5 0 0 1 .63-.062l2.66 1.773 3.71-3.71z"],["fill-rule","evenodd","d","M4.502 7a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"],["style","margin-left:auto",4,"ngIf"],[1,"bttn-post"],[1,"post-bttn","noselect",3,"click"],["class","media",4,"ngIf"],[1,"toReply"],[3,"inputConfig","post"],[1,"replyRef","upper"],[1,"aroba"],[2,"margin-left","auto"],[1,"media"],[1,"count-container"],[4,"ngIf"],[1,"remove-bttn","empty-wrapper",3,"click"],[4,"ngFor","ngForOf"],[1,"media-count",3,"ngClass","click"],[1,"selected-media",3,"src"]],template:function(t,e){if(1&t){const t=c.Pb();c.sc(0,m,2,3,"div",0),c.Ob(1,"article"),c.Ob(2,"div",1),c.Kb(3,"img",2),c.Nb(),c.Ob(4,"div",3),c.sc(5,v,5,1,"div",4),c.Kb(6,"div",5,6),c.Ob(8,"div",7),c.Ob(9,"input",8,9),c.Wb("change",(function(t){return e.onMediaSelect(t)})),c.Nb(),c.Ob(11,"div",10),c.Ob(12,"div",11),c.Wb("click",(function(){return c.nc(t),c.kc(10).click()})),c.Zb(),c.Ob(13,"svg",12),c.Kb(14,"path",13),c.Kb(15,"path",14),c.Kb(16,"path",15),c.Nb(),c.Nb(),c.Nb(),c.sc(17,O,2,1,"div",16),c.Yb(),c.Ob(18,"div",17),c.Ob(19,"div",18),c.Wb("click",(function(){return e.publishPost()})),c.uc(20," Post "),c.Nb(),c.Nb(),c.Nb(),c.sc(21,w,7,4,"div",19),c.Nb(),c.Nb()}2&t&&(c.fc("ngIf",e.postReply),c.zb(3),c.fc("src",e.user.avatar.fullPath,c.pc),c.zb(2),c.fc("ngIf",e.postReply),c.zb(12),c.fc("ngIf",e.showUploadProgress),c.zb(4),c.fc("ngIf",0!==e.selectedMediaBlob.length))},directives:[i.k,g.a,i.j,i.i],styles:["article[_ngcontent-%COMP%]{display:flex;padding:1rem 1rem 0;border-bottom:3px solid var(--primary-color)}.replyRef[_ngcontent-%COMP%]{margin-bottom:.3rem;color:var(--secondary-color);font-size:.8rem}.aroba[_ngcontent-%COMP%]{color:#06b8ff;cursor:pointer}.aroba[_ngcontent-%COMP%]:hover{color:var(--primary-color)}.a-profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:3.4rem;height:3.4rem;border-radius:50%;background-color:var(--hover-color);margin-right:.8rem;padding:.2rem;position:relative}.a-content[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column}.a-buttons[_ngcontent-%COMP%]{margin:.3rem 0}.a-buttons[_ngcontent-%COMP%], .bttn-opt[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.icon-box[_ngcontent-%COMP%]{padding:.5rem;margin-right:.3rem;cursor:pointer;border-radius:500px;outline:0}.icon-box[_ngcontent-%COMP%]:hover{background-color:var(--hover-empty-color)}.opt-icon[_ngcontent-%COMP%]{color:var(--primary-color);width:1.6rem;height:1.6rem}.bttn-post[_ngcontent-%COMP%]{margin-left:auto}.post-bttn[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;padding:.4rem 3rem;border-radius:500px;text-align:center;display:inline;cursor:pointer;background-color:var(--primary-color)}.post-bttn[_ngcontent-%COMP%]:hover{background-color:#15ac59}.save-bttn[_ngcontent-%COMP%]{margin-right:12px;font-size:1.1rem;font-weight:700;padding:.4rem 1rem;border-radius:500px;text-align:center;display:inline;cursor:pointer;background-color:var(--primary-color)}.save-bttn[_ngcontent-%COMP%]:hover{background-color:#15ac59}.toReply[_ngcontent-%COMP%]{margin-bottom:.5rem}#text-box[_ngcontent-%COMP%]{min-height:4rem;font-size:1.5rem;border:none;overflow:auto;outline:none;box-shadow:none}[contenteditable=true][_ngcontent-%COMP%]:empty:before{content:attr(placeholder);pointer-events:none;color:var(--secondary-color);display:block}.selected-media[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:30px;margin-bottom:1rem}.media-count[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;padding:.5rem 1rem;border:0;border-radius:500px;text-align:center;display:inline;cursor:pointer;background-color:var(--primary-color);color:var(--text-color);margin-right:1rem}.media-count[_ngcontent-%COMP%]:hover:not(.current-selected-media){background-color:var(--hover-solid-color)}.count-container[_ngcontent-%COMP%]{margin:1rem 0;display:flex;flex-direction:row;align-items:center}.current-selected-media[_ngcontent-%COMP%]{background-color:var(--hover-empty-color)}.remove-bttn[_ngcontent-%COMP%]{margin-left:auto;padding:.2rem .5rem;font-size:1rem;border-color:orange}"]}),t})();var I=n("OUel");const _=function(){return{destination:1,parentIndex:0}};function N(t,e){1&t&&(c.Ob(0,"div"),c.Kb(1,"app-post-publish",5),c.Nb()),2&t&&(c.zb(1),c.fc("destinationConfig",c.gc(1,_)))}function z(t,e){if(1&t){const t=c.Pb();c.Ob(0,"div",6),c.Ob(1,"span",7),c.uc(2,"In order to post you need to be logged in!"),c.Nb(),c.Ob(3,"div",8),c.Ob(4,"button",9),c.Wb("click",(function(){return c.nc(t),c.ac().auth("Login")})),c.uc(5,"Login"),c.Nb(),c.uc(6," \xa0or\xa0 "),c.Ob(7,"button",9),c.Wb("click",(function(){return c.nc(t),c.ac().auth("Register")})),c.uc(8,"Register"),c.Nb(),c.Nb(),c.Nb()}}function S(t,e){if(1&t&&(c.Mb(0),c.Kb(1,"app-posts-list",10),c.Lb()),2&t){const t=c.ac();c.zb(1),c.fc("queryUrl",t.queryUrl)}}let L=(()=>{class t{constructor(t,e,n,i,o){this.postsService=t,this.locationService=e,this.token=n,this.modalService=i,this.route=o,this.loading=!0}ngOnInit(){const t={explore:{query:"/posts?parent[size]=0&childLevel=0&[limit]=10",auth:!1},home:{query:"/posts/user",auth:!0}};this.isLogged$=this.token.user$.pipe(Object(s.a)(t=>!!t)),this.route.params.subscribe(e=>{this.needsLogin=t[e.page].auth,this.queryUrl=t[e.page].query})}auth(t){this.modalService.open({type:"default",content:[{title:"Auth in order to post"},{module:"Auth",component:t,params:{navigateEnd:!1}}]},{action:"add",stack:[t]})}}return t.\u0275fac=function(e){return new(e||t)(c.Jb(r.a),c.Jb(a.a),c.Jb(l.a),c.Jb(d.a),c.Jb(o.a))},t.\u0275cmp=c.Db({type:t,selectors:[["app-posts-page"]],decls:7,vars:7,consts:[[1,"container"],[4,"ngIf","ngIfElse"],["class","border auth-container"],["notLogged",""],[4,"ngIf"],[3,"destinationConfig"],[1,"notLogged"],[1,"auth-text"],[1,"bttn-group"],[1,"bttn","solid-bttn",3,"click"],[3,"queryUrl"]],template:function(t,e){if(1&t&&(c.Ob(0,"div",0),c.sc(1,N,2,2,"div",1),c.bc(2,"async"),c.sc(3,z,9,0,"ng-template",2,3,c.tc),c.sc(5,S,2,1,"ng-container",4),c.bc(6,"async"),c.Nb()),2&t){const t=c.kc(4);c.zb(1),c.fc("ngIf",c.cc(2,3,e.isLogged$))("ngIfElse",t),c.zb(4),c.fc("ngIf",!e.needsLogin&&null!==e.needsLogin||c.cc(6,5,e.isLogged$))}},directives:[i.k,k,I.a],pipes:[i.b],styles:[".notLogged[_ngcontent-%COMP%]{border-bottom:1.5px solid var(--primary-color);display:flex;flex-direction:column;justify-content:center;align-items:center;padding:2rem}.auth-text[_ngcontent-%COMP%]{font-size:1.2rem;padding-bottom:1rem;text-align:center}.bttn-group[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%}.bttn[_ngcontent-%COMP%]{flex:1;max-width:10rem;padding:.8rem 0}"]}),t})();var R=n("5+tZ"),j=n("SxV6");const U=function(t){return{i:t,type:"parent"}},D=function(){return{destination:0}},F=function(){return{owner:!1,thread:!0}};function K(t,e){if(1&t&&(c.Ob(0,"div"),c.Ob(1,"div"),c.Kb(2,"app-post",5),c.Nb(),c.Nb()),2&t){const t=e.$implicit,n=e.index;c.zb(2),c.fc("contextInfo",c.hc(4,U,n))("publishConfig",c.gc(6,D))("inputConfig",c.gc(7,F))("post",t)}}function T(t,e){if(1&t&&(c.Mb(0),c.sc(1,K,3,8,"div",4),c.Lb()),2&t){const t=c.ac();c.zb(1),c.fc("ngForOf",t.mainPost.parent)}}const J=function(){return{empty:!0,owner:!1,thread:!0}},B=function(){return{text:"Loading..."}};function $(t,e){if(1&t&&(c.Ob(0,"div"),c.Ob(1,"div"),c.Kb(2,"app-post",5),c.Nb(),c.Nb()),2&t){const t=e.index;c.zb(2),c.fc("contextInfo",c.hc(4,U,t))("publishConfig",c.gc(6,D))("inputConfig",c.gc(7,J))("post",c.gc(8,B))}}function W(t,e){if(1&t&&(c.Mb(0),c.sc(1,$,3,9,"div",4),c.Lb()),2&t){const t=c.ac();c.zb(1),c.fc("ngForOf",t.mainPost.parent)}}const E=function(){return{destination:1,parentIndex:0}},A=function(){return{owner:!1}};function X(t,e){if(1&t&&(c.Ob(0,"div"),c.Ob(1,"div",6),c.Kb(2,"app-post",7),c.Nb(),c.Nb()),2&t){const t=c.ac();c.zb(2),c.fc("publishConfig",c.gc(3,E))("inputConfig",c.gc(4,A))("post",t.mainPost)}}const q=function(t){return{i:t,type:"reply"}},V=function(t){return{destination:0,parentIndex:t}},Q=function(t,e){return{destination:2,parentIndex:t,childIndex:e}},G=function(t){return{thread:t}};function H(t,e){if(1&t&&(c.Ob(0,"div"),c.Ob(1,"div",11),c.Kb(2,"app-post",10),c.Nb(),c.Nb()),2&t){const t=e.$implicit,n=e.index,i=e.last,o=c.ac().index;c.zb(2),c.fc("contextInfo",c.hc(5,q,o))("publishConfig",c.hc(7,V,o))("deleteConfig",c.ic(9,Q,o,n))("inputConfig",c.hc(12,G,!i))("post",t)}}const Z=function(t){return{i:t,type:"post"}},Y=function(t,e){return{destination:2,parentIndex:t,childIndex:e,end:!0}},tt=function(t){return{destination:1,parentIndex:t}};function et(t,e){if(1&t&&(c.Ob(0,"div",9),c.Ob(1,"div"),c.Kb(2,"app-post",10),c.Nb(),c.sc(3,H,3,14,"div",4),c.Nb()),2&t){const t=e.$implicit,n=e.index;c.zb(2),c.fc("contextInfo",c.hc(6,Z,n))("publishConfig",c.ic(8,Y,n,null==t.child?null:t.child.length))("deleteConfig",c.hc(11,tt,n))("inputConfig",c.hc(13,G,0!==(null==t.child?null:t.child.length)))("post",t),c.zb(1),c.fc("ngForOf",t.child)}}function nt(t,e){1&t&&(c.Ob(0,"h3"),c.uc(1,"No replies yet"),c.Nb())}function it(t,e){if(1&t&&(c.Ob(0,"div"),c.sc(1,et,4,15,"div",8),c.Ob(2,"div",3),c.sc(3,nt,2,0,"h3",2),c.Nb(),c.Nb()),2&t){const t=c.ac(2);c.zb(1),c.fc("ngForOf",t.repliesList),c.zb(2),c.fc("ngIf",!t.repliesList||0===(null==t.repliesList?null:t.repliesList.length))}}function ot(t,e){if(1&t&&(c.Ob(0,"div"),c.sc(1,it,4,2,"div",2),c.Nb()),2&t){const t=c.ac();c.zb(1),c.fc("ngIf",!t.loading)}}function st(t,e){1&t&&(c.Ob(0,"h3"),c.uc(1,"Searching replies..."),c.Nb())}const ct=[{path:"post/:postId",component:(()=>{class t{constructor(t,e,n){this.route=t,this.postsService=e,this.locationService=n,this.loading=!0}ngOnInit(){this.locationService.setStack(["Reply Page"]),this.sub2=this.postsService.posts$.subscribe(t=>{this.repliesList=t}),this.sub$=this.postsService.post$.subscribe(t=>{if(t){this.mainPost=t;const e=this.isPopulated(t.parent),n=this.isPopulated(t.child);e&&n&&this.repliesList||(this.loading=!0,this.postsService.getPostById(t._id).subscribe(t=>{this.mainPost=Object.assign({},this.mainPost,{parent:t.parent,child:t.child}),this.loading=!1}))}else this.loading=!0,this.route.params.pipe(Object(R.a)(t=>this.postsService.getPostById(t.postId)),Object(j.a)()).subscribe(t=>{this.mainPost=Object.assign({},t),this.loading=!1})})}ngOnChanges(t){console.warn(t)}ngOnDestroy(){this.sub$.unsubscribe(),this.sub2.unsubscribe(),this.postsService.clearAll()}isPopulated(t){return t&&t.every(t=>"string"!=typeof t)||0===t.length}checkParent(t){return(null==t?void 0:t.parent.length)>0&&"string"!=typeof(null==t?void 0:t.parent[0])}}return t.\u0275fac=function(e){return new(e||t)(c.Jb(o.a),c.Jb(r.a),c.Jb(a.a))},t.\u0275cmp=c.Db({type:t,selectors:[["app-post-article"]],features:[c.xb],decls:8,vars:5,consts:[[1,"container"],[1,"post-list"],[4,"ngIf"],[2,"padding","2rem","text-align","center"],[4,"ngFor","ngForOf"],[3,"contextInfo","publishConfig","inputConfig","post"],[1,"main-post"],[3,"publishConfig","inputConfig","post"],["class","reply-container",4,"ngFor","ngForOf"],[1,"reply-container"],[3,"contextInfo","publishConfig","deleteConfig","inputConfig","post"],[1,"reply"]],template:function(t,e){1&t&&(c.Ob(0,"div",0),c.Ob(1,"div",1),c.sc(2,T,2,1,"ng-container",2),c.sc(3,W,2,1,"ng-container",2),c.sc(4,X,3,5,"div",2),c.sc(5,ot,2,1,"div",2),c.Ob(6,"div",3),c.sc(7,st,2,0,"h3",2),c.Nb(),c.Nb(),c.Nb()),2&t&&(c.zb(2),c.fc("ngIf",e.checkParent(e.mainPost)),c.zb(1),c.fc("ngIf",e.mainPost&&!e.checkParent(e.mainPost)),c.zb(1),c.fc("ngIf",e.mainPost),c.zb(1),c.fc("ngIf",e.repliesList),c.zb(2),c.fc("ngIf",e.loading))},directives:[i.k,i.j,g.a],styles:[".main-post[_ngcontent-%COMP%]{border-bottom:15px solid var(--primary-color);background:var(--hover-color)}.container[_ngcontent-%COMP%]{width:100%;height:92%;display:flex;flex-direction:column}.post-list[_ngcontent-%COMP%]{overflow:scroll;flex-grow:1}.post-list[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.reply-container[_ngcontent-%COMP%]{border-bottom:.15rem solid var(--primary-color)}"]}),t})()},{path:":page",component:L},{path:"",redirectTo:"/explore",pathMatch:"full"}];let rt=(()=>{class t{}return t.\u0275mod=c.Hb({type:t}),t.\u0275inj=c.Gb({factory:function(e){return new(e||t)},imports:[[o.e.forChild(ct)],o.e]}),t})();var at=n("ecLf"),lt=n("iTUp");let dt=(()=>{class t{}return t.components={PostComponent:g.a,PostPublishComponent:k,PostsListComponent:I.a},t.\u0275mod=c.Hb({type:t}),t.\u0275inj=c.Gb({factory:function(e){return new(e||t)},imports:[[i.c,rt,at.a,lt.a]]}),t})()}}]);