{"version":3,"sources":["webpack:///src/app/modules/posts/post-article/post-article.component.ts","webpack:///src/app/modules/posts/post-article/post-article.component.html","webpack:///src/app/modules/posts/post-publish/post-publish.component.ts","webpack:///src/app/modules/posts/post-publish/post-publish.component.html","webpack:///src/app/modules/posts/post/post.component.ts","webpack:///src/app/modules/posts/post/post.component.html","webpack:///src/app/modules/posts/posts-list/posts-list.component.ts","webpack:///src/app/modules/posts/posts-list/posts-list.component.html","webpack:///src/app/modules/posts/posts-page/posts-page.component.ts","webpack:///src/app/modules/posts/posts-page/posts-page.component.html","webpack:///src/app/modules/posts/posts-routing.module.ts","webpack:///src/app/modules/posts/posts.component.ts","webpack:///src/app/modules/posts/posts.component.html","webpack:///src/app/modules/posts/posts.module.ts","webpack:///src/app/pipes/date-ago.pipe.ts","webpack:///src/app/pipes/pipes.module.ts","webpack:///src/app/pipes/user.pipe.ts"],"names":["PostArticleComponent","route","postsService","locationService","loading","setStack","sub2","posts$","subscribe","posts","repliesList","sub$","post$","post","mainPost","haveParents","isPopulated","parent","haveChildren","child","getPostById","_id","fullPost","Object","assign","params","pipe","p","postId","changes","unsubscribe","clearAll","arr","every","e","length","selector","templateUrl","styleUrls","PostPublishComponent","modalService","token","postReply","destinationConfig","selectedMedia","selectedMediaBlob","selectedMediaIndex","showUploadProgress","uploadProgress","user","getUserData","input","postInput","nativeElement","innerText","emitResponse","text","media","publisher","replyPost","publishPost","publisher$","res","progress","hasOwnProperty","clear","mediaSelect","value","event","target","files","open","type","content","title","html","action","stack","key","filter","tempFilter","valid","message","push","createFormData","url","mediaBlob","format","entries","index","splice","file","cb","reader","FileReader","readAsDataURL","onload","_event","result","response","splittedFormat","match","size","uploadGallery","completed","onMediaSelect","selectedIndex","fullPath","PostComponent","navbarService","renderer","contextInfo","i","undefined","config","showOpt","openPage","owner","replied","publishing","deleted","liked","shared","reported","thread","tooltip","empty","count","replies","likes","shares","mediaSelIdx","replyingProgress","different","previousValue","currentValue","firstChange","_inputConfig","_post","unshift","data","uid","inputConfig","whoLiked","includes","confirm","go","checkAuth","publishConfig","module","component","modal","location","removeItemFromStack","addItemToStack","likePost","deletePost","deleteConfig","forceClose","setMainPost","window","host","isLogged","navigateEnd","src","username","replyRef","Array","fill","localUser","selFields","id","name","avatar","countData","auth","getUserId","PostsListComponent","showOptPosts","postsList$","queryUrl","getPostsList","pageInfo","pagination","_queryUrl","PostsPageComponent","user$","_","refreshList","routeData","snapshot","needsLogin","routes","path","page","query","redirectTo","pathMatch","PostsRoutingModule","forChild","imports","exports","PostsComponent","PostsModule","components","declarations","DateAgoPipe","args","seconds","Math","floor","Date","intervals","counter","PipesModule","UserPipe"],"mappings":"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","file":"default~src-app-modules-posts-posts-module~src-app-modules-profile-profile-module-es5.js","sourcesContent":["import { Component, OnInit, OnDestroy, OnChanges } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { PostsService } from '../posts.service';\nimport { LocationService } from 'src/app/services/location.service';\nimport { first, flatMap } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-post-article',\n  templateUrl: './post-article.component.html',\n  styleUrls: ['./post-article.component.css'],\n})\nexport class PostArticleComponent implements OnInit, OnChanges, OnDestroy {\n\n\n  mainPost;\n  repliesList;\n\n  sub$;\n  sub2;\n\n  loading = true;\n\n  constructor(\n    private route: ActivatedRoute,\n    private postsService: PostsService,\n    private locationService: LocationService,\n  ) { }\n\n  ngOnInit(): void {\n    this.locationService.setStack(['Reply Page']);\n\n    // Replies List\n    this.sub2 = this.postsService.posts$.subscribe(\n      posts => {\n        this.repliesList = posts;\n      }\n    );\n\n    // Main Post\n    this.sub$ = this.postsService.post$.subscribe(post => {\n\n      // Page already loaded and the selected post is known\n      if (post) {\n        this.mainPost = post;\n\n        const haveParents = this.isPopulated(post.parent);\n        const haveChildren = this.isPopulated(post.child);\n        // If we do not have the above declared vars then search them\n        // If replies list is null, search too (this happens when service\n        // has cleared the list)\n        if (!haveParents || !haveChildren || !this.repliesList) {\n          // This function will update replies list too\n          this.loading = true;\n          this.postsService.getPostById(post._id).subscribe(\n            fullPost => {\n              // Update main post data\n              this.mainPost = Object.assign({}, this.mainPost, {\n                parent: fullPost.parent,\n                child: fullPost.child\n              });\n              this.loading = false;\n            }\n          )\n        }\n      }\n      // Page first load: get url param and search post\n      else {\n        // Get only first response. Once the main post changes,\n        // the first condition will be triggered\n        this.loading = true;\n        this.route.params.pipe(\n          flatMap(p => this.postsService.getPostById(p.postId)),\n          first()\n        ).subscribe(fullPost => {\n          // Set main post as copy because we do not want to\n          // pass the child attribute by reference\n          this.mainPost = {...fullPost};\n          this.loading = false;\n        });\n      }\n    });\n\n  }\n\n  ngOnChanges(changes) {\n  }\n\n  ngOnDestroy(): void {\n    this.sub$.unsubscribe();\n    this.sub2.unsubscribe();\n    this.postsService.clearAll();\n  }\n\n  isPopulated(arr) {\n    // cond1: all array elements are not strings (this means we only have ids)\n    // cond2: array empy\n    return arr && arr.every(e => typeof e !== 'string') || arr.length === 0;\n  }\n\n  checkParent(post) {\n    return (post?.parent.length > 0 && typeof post?.parent[0] !== 'string');\n  }\n\n}\n","<div class=\"container\">\n  <div class=\"post-list\">\n   \n    \n      <!-- Upper post -->\n      <ng-container *ngIf=\"checkParent(mainPost)\">\n        <div  *ngFor=\"let upperPost of mainPost.parent; let i=index\">\n          <div>\n            <app-post\n            [contextInfo]=\"{i:i, type:'parent'}\"\n            [publishConfig]=\"{destination:0}\"\n            [inputConfig]=\"{owner:false, thread: true}\"\n            [post]=\"upperPost\">\n            </app-post>\n          </div>\n        </div>\n      </ng-container>\n      <ng-container *ngIf=\"mainPost && !checkParent(mainPost)\">\n        <div  *ngFor=\"let upperPost of mainPost.parent; let i=index\">\n          <div>\n            <app-post\n            [contextInfo]=\"{i:i, type:'parent'}\"\n            [publishConfig]=\"{destination:0}\"\n            [inputConfig]=\"{empty:true, owner:false, thread: true}\"\n            [post]=\"{text:'Loading...'}\">\n            </app-post>\n          </div>\n        </div>\n      </ng-container>\n\n      <!-- Main Post -->\n    <div *ngIf=\"mainPost\">\n      <div class=\"main-post\">\n        <app-post\n        [publishConfig]=\"{destination: 1, parentIndex:0}\"\n        [inputConfig]=\"{owner:false}\"\n        [post]=\"mainPost\">\n        </app-post>\n      </div>\n    </div>\n\n    <!-- Replies -->\n    <div *ngIf=\"repliesList\">\n      <div *ngIf=\"!loading\">\n        <div class=\"reply-container\" *ngFor=\"let reply of repliesList; index as pIndex\">\n          <div>\n            <app-post\n            [contextInfo]=\"{i:pIndex, type:'post'}\"\n            [publishConfig]=\"{destination:2, parentIndex: pIndex, childIndex:reply.child?.length, end: true}\"\n            [deleteConfig]=\"{destination:1, parentIndex: pIndex}\"\n            [inputConfig]=\"{thread: (reply.child?.length !== 0)}\"\n            [post]=\"reply\">\n            </app-post>\n          </div>\n  \n          <!-- Reply to reply (folowing thread) -->\n          <div *ngFor=\"let childReply of reply.child; index as cIndex; last as isLast\">\n            <div class=\"reply\">\n              <app-post\n              [contextInfo]=\"{i:pIndex, type:'reply'}\"\n              [publishConfig]=\"{destination:0, parentIndex: pIndex}\"\n              [deleteConfig]=\"{destination:2, parentIndex: pIndex, childIndex: cIndex}\"\n              [inputConfig]=\"{thread: !isLast}\"\n              [post]=\"childReply\">\n              </app-post>\n            </div>\n          </div>\n        </div>\n        \n        <div style=\"padding: 2rem; text-align: center;\">\n          <h3 *ngIf=\"(!repliesList || repliesList?.length === 0)\">No replies yet</h3>\n        </div>\n      </div>\n    </div>\n\n    <div style=\"padding: 2rem; text-align: center;\">\n      <h3 *ngIf=\"loading\">Searching replies...</h3>\n    </div>\n    \n  </div>\n</div>","import { Component, OnInit, ViewChild, Input, ElementRef } from '@angular/core';\nimport { PostsService } from '../posts.service';\nimport { ModalService } from 'src/app/shared/modal/modal.service';\nimport { LocationService } from 'src/app/services/location.service';\nimport { TokenService } from 'src/app/services/token.service';\nimport { map, takeLast, tap } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-post-publish',\n  templateUrl: './post-publish.component.html',\n  styleUrls: ['./post-publish.component.css']\n})\nexport class PostPublishComponent implements OnInit {\n  @ViewChild('postInput') postInput;\n  @Input() postReply = null;\n  @Input() destinationConfig = null;\n  user;\n\n  publisher$;\n\n  constructor(\n    private postsService: PostsService,\n    private modalService: ModalService,\n    private token: TokenService,\n  ) { }\n\n  ngOnInit(): void {\n    this.user = this.token.getUserData();\n  }\n\n  publishPost() {\n    const input = this.postInput.nativeElement.innerText;\n    if (!input) return;\n\n    // This way we can close the modal but still send data\n    this.modalService.emitResponse(false, false);\n\n    // Create post payload and check if media was uploaded\n    const post = {\n      text: input,\n      media: this.selectedMedia.length !== 0 ? this.selectedMedia : null\n    };\n\n    // Check if it is a post or a reply\n    const publisher = () => {\n      return this.postReply ?\n             this.postsService.replyPost(this.postReply._id, post, this.destinationConfig) :\n             this.postsService.publishPost(post, this.destinationConfig) ;\n    };\n\n    this.publisher$ = publisher().subscribe(res => {\n      if (res.progress) {\n        this.showUploadProgress = true;\n        this.uploadProgress = res.progress;\n      }\n      else { this.showUploadProgress = false; }\n      // This response catches both progress and published post/reply\n      // Keep emitting responses until progress property does not exist\n      this.modalService.emitResponse(!res.hasOwnProperty('progress'), res);\n    });\n\n    // Empty input and media\n    this.clear();\n  }\n\n  clear() {\n    // Clear input\n    this.postInput.nativeElement.innerText = '';\n    this.mediaSelect.nativeElement.value = '';\n    this.selectedMedia = [];\n    this.selectedMediaBlob = [];\n    this.selectedMediaIndex = 0;\n  }\n\n  /*\n   *  MEDIA UPLOAD \n   *\n   */\n  @ViewChild('mediaSelect') mediaSelect: ElementRef;\n  selectedMedia = [];\n  selectedMediaBlob = [];\n  selectedMediaIndex = -1;\n  onMediaSelect(event) {\n    // Check number of media selected\n    if (this.selectedMedia.length + event.target.files.length > 5) {\n      this.modalService.open(\n        {type: 'default', content: [{title: 'Media error'},\n                                    {html: '<p>You can only attach 5 media files per post!</p>'}]},\n        {action: 'add', stack:['Media', 'Error']});\n      return;\n    }\n\n    for (const [key, media] of Object.entries(event.target.files)) {\n      const filter = this.tempFilter(media);\n      if (!filter.valid) {\n        // Open modal informing the client why the media was not uploaded\n        this.modalService.open(\n          {type: 'default', content: [{title: 'Media error'},\n                                      {html: filter.message}, \n                                      {html: '<p>Try with images or short videos!</p>'}]},\n          {action: 'add', stack:['Media', 'Error']});\n        // Stop function\n        return;\n      };\n      // Set image file\n      this.selectedMedia.push(media);\n      // Display image\n      this.createFormData(media, url => {\n        const mediaBlob = {format: filter.format, url}\n        this.selectedMediaBlob.push(mediaBlob);\n      });\n    }\n    // Always select last media on upload\n    this.selectedMediaIndex = this.selectedMedia.length-1;\n\n  }\n\n  onCancelSelectedMedia(index) {\n    this.selectedMedia.splice(index, 1);\n    this.selectedMediaBlob.splice(index, 1);\n    if (this.selectedMediaIndex > this.selectedMedia.length-1) {\n      if (this.selectedMedia.length !== 0) {\n        this.selectedMediaIndex -= 1;        \n      }\n    }\n  }\n\n\n  private createFormData(file, cb) {\n    const reader = new FileReader;\n    reader.readAsDataURL(file);\n    reader.onload = (_event:any) => { \n      // Clear file input\n      this.mediaSelect.nativeElement.value = '';\n      cb(reader.result)\n    };\n  }\n\n  private tempFilter(media) {\n    let response: {format: string, valid: boolean, message: string} = {\n      format: null,\n      valid: null,\n      message: null\n    };\n    const splittedFormat = media.type.match(/(\\w+)\\/(\\w+)?/);\n    response.format = splittedFormat[1]\n    if (response.format === 'video') {\n      response.valid = !(media.size > 15000000);\n      response.message = 'Max size is 15MB';\n    }\n    else if (response.format === 'image') {\n      response.valid = true;\n    }\n    else {\n      response.valid = false;\n      response.message = `'<strong>${splittedFormat[2]}</strong>' is not a valid format.`;\n    }\n    return response;\n  }\n\n  showUploadProgress = false;\n  uploadProgress: any = 0;\n  private getGalleryUrl() {\n    this.showUploadProgress = true;\n    return this.postsService.uploadGallery(this.selectedMedia).pipe(\n      tap(res => {\n        if (res.progress) {\n          this.uploadProgress = res.progress;\n          this.modalService.emitResponse(false, {progress: res.progress});\n        }\n        else if (res.completed) {\n          this.uploadProgress = 'Uploaded';\n        }\n      }),\n      takeLast(1),\n      map(res => res)\n    );\n  }\n\n}\n","<div *ngIf=\"postReply\" class=\"toReply\">\n  <app-post [inputConfig]=\"{showOpt:false, thread:true, openPage: false}\" [post]=\"postReply\"></app-post>\n</div>\n<article>\n  <div class=\"a-profile\">\n    <img [src]=\"user.avatar.relativePath\">\n  </div>\n  <div class=\"a-content\">\n\n    <div class=\"replyRef upper\" *ngIf=\"postReply\">\n      <span>Replying to&nbsp;</span>\n      <span class=\"aroba\">@{{ postReply.owner.username }}</span>\n    </div>\n\n    <div #postInput contenteditable=\"true\" id=\"text-box\" placeholder=\"What's happening?\"></div>\n\n    <div class=\"a-buttons\">\n      <input #mediaSelect type=\"file\" multiple (change)=\"onMediaSelect($event)\" style=\"display: none;\">\n\n      <div class=\"bttn-opt\">\n        <div class=\"icon-box\" (click)=\"mediaSelect.click()\">\n          <svg class=\"bi bi-image opt-icon\" width=\"1em\" height=\"1em\" viewBox=\"0 0 16 16\" fill=\"currentColor\"\n            xmlns=\"http://www.w3.org/2000/svg\">\n            <path fill-rule=\"evenodd\"\n              d=\"M14.002 2h-12a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1zm-12-1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12z\" />\n            <path\n              d=\"M10.648 7.646a.5.5 0 0 1 .577-.093L15.002 9.5V14h-14v-2l2.646-2.354a.5.5 0 0 1 .63-.062l2.66 1.773 3.71-3.71z\" />\n            <path fill-rule=\"evenodd\" d=\"M4.502 7a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z\" />\n          </svg>\n        </div>\n      </div>\n\n      <div style=\"margin-left:auto\" *ngIf=\"showUploadProgress\">\n        Uploading {{ uploadProgress }}%\n      </div>\n\n\n\n      <div class=\"bttn-post\">\n        <!-- <div class=\"save-bttn\" (click)=\"publishPost()\">\n          Save Draft\n        </div> -->\n        <div class=\"post-bttn noselect\" (click)=\"publishPost()\">\n          Post\n        </div>\n      </div>\n      \n    </div>\n\n    <!-- MEDIA -->\n    <div class=\"media\" *ngIf=\"selectedMediaBlob.length !== 0\">\n      <div class=\"count-container\">\n        <div *ngIf=\"selectedMediaBlob.length > 1\">\n          <ng-container *ngFor=\"let media of selectedMediaBlob; let i=index\">\n            <button\n              (click)=\"selectedMediaIndex = i\"\n              [ngClass]=\"{'current-selected-media': selectedMediaIndex === i}\"\n              class=\"media-count\">{{ i +1 }}</button>\n          </ng-container>\n        </div>\n        <div class=\"remove-bttn empty-wrapper\" (click)=\"onCancelSelectedMedia(selectedMediaIndex)\">Remove media {{ selectedMediaIndex +1 }}</div>\n      </div>\n\n      <div *ngIf=\"selectedMediaBlob[selectedMediaIndex]?.format === 'image'\">\n        <img class=\"selected-media\" [src]=\"selectedMediaBlob[selectedMediaIndex].url\">\n      </div>\n\n      <div *ngIf=\"selectedMediaBlob[selectedMediaIndex]?.format === 'video'\">\n        <span><i>Video thumbnail</i></span>\n        <video class=\"selected-media\" [src]=\"selectedMediaBlob[selectedMediaIndex].url\"></video>\n      </div>\n    </div>\n    \n  </div>\n</article>\n","import { Component, OnInit, Input, ViewChild, OnChanges, ElementRef, OnDestroy, Renderer2, ViewChildren, ContentChild } from '@angular/core';\nimport { PostsService } from '../posts.service';\nimport { ModalService } from 'src/app/shared/modal/modal.service';\nimport { TokenService } from 'src/app/services/token.service';\nimport { NavbarService } from 'src/app/shared/navbar/navbar.service';\nimport { LocationService } from 'src/app/services/location.service';\n\n@Component({\n  selector: 'app-post',\n  templateUrl: './post.component.html',\n  styleUrls: ['./post.component.css']\n})\nexport class PostComponent implements OnInit, OnChanges {\n\n  @Input() contextInfo = {i: 0, type:undefined};\n  @Input() publishConfig: {destination, parentIndex?, childIndex?, end?};\n  @Input() deleteConfig: {destination, parentIndex, childIndex?};\n\n  @ViewChild('triggerTooltip') triggerTooltip;\n\n  _inputConfig;\n  @Input()\n    set inputConfig(inputConfig) {\n      // Reassign default values by the given ones\n      this.config = Object.assign(this.config, inputConfig);\n      this._inputConfig = inputConfig;\n    }\n    get inputConfig() {\n      return this._inputConfig || {};\n    }\n\n  _post;\n  @Input()\n    set post(post) {\n      // Set selected media index\n      if (post.media && post.media.length !== 0 && !post.media[0].selectedIndex) {\n        post.media.unshift({selectedIndex: 1});\n      }\n      // Simulate empty user for loading purposes\n      if (this.config.empty) {\n        post._id = 'loading...';\n        post.replyRef = Array(this.contextInfo.i).fill('???');\n        this._post = post;\n      }\n      // If post is incompleted, use default values\n      else if (!post._id) {\n        // Incompleted post means that the owner is the current publisher\n        const localUser = this.token.getUserData();\n        const selFields = ({id, name, username, avatar}) => ({_id:id, name, username, avatar});\n        post.owner = selFields(localUser);\n        // This change in config is done after inputConfig set\n        this.config.owner = true;\n        this.config.loading = true;\n        this.config.thread = false;\n\n        this._post = post;\n      }\n      else {\n        // Count replies, likes, shares\n        this.countData(post);\n        // Check if liked/shared\n        this._post = this.auth(post, this.token.getUserId());\n        this._post = {...post};\n      }\n    }\n    get post() {\n      return this._post;\n    }\n\n  config = {\n    showOpt: true,\n    openPage: true,\n    owner: false,\n    replied: false,\n    publishing: false,\n    deleted: false,\n    liked: false,\n    shared: false,\n    reported: false,\n    thread: false,\n    tooltip: true,\n    loading: false,\n    empty: false\n  }\n\n  count = {\n    replies: 0,\n    likes: 0,\n    shares: 0\n  };\n\n  mediaSelIdx = 0;\n\n  constructor(\n    private postsService: PostsService,\n    private modalService: ModalService,\n    private token: TokenService,\n    private locationService: LocationService,\n    private navbarService: NavbarService,\n    private renderer: Renderer2\n  ) { }\n\n\n  ngOnInit(): void {\n  }\n\n  ngOnChanges(changes) {\n    const different = changes.post?.previousValue?._id !== changes.post?.currentValue._id\n    if (!changes.post?.firstChange && different) {\n      // Reset values when changing posts\n      this.config = Object.assign(this.config, this._inputConfig);\n\n      if (this._post.media && this._post.media.length !== 0 && !this._post.media.selectedIndex) {\n        this._post.media.unshift({selectedIndex: 1});\n      }\n      this.config.replied = false;\n      this.config.deleted = false;\n    }\n  }\n\n  private countData(data) {\n    this.count = {\n      replies: data.child?.length || 0,\n      likes: data.likes,\n      shares: 0 // not added yet\n    };\n  }\n\n  private auth(post, uid?) {\n    // Set owner only if uid corresponds and is not overwritten by inputConfig\n    this.config.owner = (post.owner._id === uid) && \n                        (!this.inputConfig.hasOwnProperty('owner') || this.inputConfig.owner);\n    this.config.liked = post.whoLiked.includes(uid);\n    if (uid) {\n      post.confirm = {\n        owner: this.config.owner,\n        liked: this.config.liked\n      }\n    }\n    return post;\n  }\n\n  goToUser(uid) {\n    if (!this.config.showOpt) return;\n    this.navbarService.go(`/u/${uid}`);\n  }\n\n  replyingProgress = 0;\n  onReply() {\n    if (!this.checkAuth('In order to reply a post you need to be logged in')) return;\n\n    const params = {postReply: this.post, destinationConfig: this.publishConfig};\n    const content = [\n      { module: 'Posts', component:'PostPublish', params}\n    ];\n    const modal = {type: 'default', content};\n    const location = {action: 'add', stack: ['Reply']};\n    this.modalService.open(modal, location, (res) => {\n      if (!res) {\n\n        this.config.replied = false;\n        this.config.publishing = true;\n        // Now, reply is being published, so we can change location to indicate that\n        this.locationService.removeItemFromStack(2);\n        this.locationService.addItemToStack(['Publishing reply...'])\n      } \n      else if (res && res.hasOwnProperty('progress')) {\n        this.replyingProgress = res.progress;\n      }\n      else {\n        this.count.replies += 1;\n        this.config.publishing = false;\n        this.config.replied = true;\n        this.replyingProgress = 0;\n\n        // In this cases (or destionation==0 too), parent child is not updated,\n        // so we must do it manually\n        if (['list', 'reply'].includes(this.contextInfo?.type) ) {\n          this.post.child.push(res);\n        }\n      }\n    });\n  }\n\n  onLike() {\n    if (!this.checkAuth('In order to like a post you need to be logged in')) return;\n    if (this.config.liked) {\n      this.config.liked = false;\n      this.count.likes -= 1;\n    }\n    else {\n      this.config.liked = true;\n      this.count.likes += 1;\n    }\n    this.postsService.likePost(this.post._id)\n  }\n\n  onDelete() {\n    this.postsService.deletePost(this.post._id, this.deleteConfig);\n  }\n\n  openReplyPage() {\n    if (!this.config.openPage) return;\n    this.modalService.forceClose();\n    this.postsService.setMainPost({...this.post}, this.contextInfo);\n    this.navbarService.go('/post/'+this.post._id);\n  }\n\n  onShare() {\n    const url = `${window.location.host}/p/${this.post._id}`; \n    const modal = {type: 'default', content: [\n      { title: 'Share a post' },\n      { html: `<p align=\"center\">${url}</p>` }\n    ]};\n    const location = {action: 'add', stack: ['Share']};\n    this.modalService.open(modal, location);\n  }\n\n  checkAuth(message) {\n    if (this.token.isLogged()) {\n      return true;\n    }\n    else {\n      const modal = {type: 'default', content: [\n        { title: message },\n        { module: 'Auth', component: 'Login', params: {navigateEnd: false} }\n      ]};\n      const location = {action: 'add', stack: ['Login']};\n      this.modalService.open(modal, location);\n      return false\n    }\n  }\n\n  openMedia(src) {\n    const content = [\n      { title: `Media from @${this.post.owner.username}` },\n      { html: `<img width=\"100%\" src=\"${src}\">` }\n    ]\n\n    const modal = {type: 'extended', content};\n    const location = {action: 'add', stack: ['Media']};\n    this.modalService.open(modal, location);\n  }\n\n}\n\n","<article *ngIf=\"post\" [ngClass]=\"config.openPage && 'select-hover'\" [ngStyle]=\"config.loading && {'filter': 'blur(1.5px)'}\">\n\n  \n  <div class=\"route\" (click)=\"openReplyPage()\"></div>\n\n  <div class=\"post\">\n    <div class=\"a-profile\">\n      <div *ngIf=\"config.thread\" class=\"thread-line\"></div>\n      <div class=\"a-profile-avatar\" *ngIf=\"post.owner\">\n        <ng-container *ngIf=\"config.showOpt\">\n          <tooltip-wrapper\n          (clicked)=\"goToUser($event)\"\n          [params]=\"{user: post.owner}\"\n          [trigger]=\"triggerTooltip\">\n            <img #obj class=\"a-avatar\" [src]=\"post.owner.avatar.relativePath\">\n          </tooltip-wrapper>\n        </ng-container>\n        <ng-container *ngIf=\"!config.showOpt\">\n          <img class=\"a-avatar\" [src]=\"post.owner.avatar.relativePath\">\n        </ng-container>\n      </div>\n      <div *ngIf=\"config.empty\">\n        <img class=\"a-avatar\" style=\"background-color: lightgray;\">\n      </div>\n    </div>\n  \n    <div class=\"a-content\">\n      <div class=\"a-acc\">\n        <span class=\"a-username\">\n          <span>\n            <div>\n              <span class=\"aroba\" #triggerTooltip>\n                @{{ post.owner.username }}\n              </span>\n              <span> - {{ post.createdAt | dateAgo}}</span>\n            </div>\n          </span>\n        </span>\n        <div class=\"delete-bttn\" style=\"margin-left: auto\" *ngIf=\"config.owner && config.showOpt && !config.loading\">\n          <span title=\"Delete post\" class=\"material-icons\" (click)=\"onDelete()\">clear</span>\n        </div>\n      </div>\n\n      <div class=\"replyRef\" *ngIf=\"post.replyRef && post.replyRef.length !== 0\">\n        <span>Replying to&nbsp;</span>\n        <div class=\"arobas\" *ngFor=\"let user of post.replyRef; let i=index\">\n          <span class=\"aroba\" (click)=\"goToUser(user)\">{{ user }}</span>\n          <span *ngIf=\"i !== post.replyRef.length-1\">&nbsp;>&nbsp;</span>\n        </div>\n      </div>\n      <div class=\"a-text\">\n        {{ post.text }}\n      </div>\n\n\n      <!-- MEDIA -->\n      <div *ngIf=\"post.media && post.media.length !== 0\">\n        <div class=\"count-container\">\n          <div *ngIf=\"post.media.length > 2\">\n            <ng-container *ngFor=\"let media of post.media.slice(1); let i=index\">\n              <button\n                [title]=\"'Change to image '.concat(i+1)\"\n                (click)=\"post.media[0].selectedIndex = i+1\"\n                [ngClass]=\"{'current-selected-media': post.media[0].selectedIndex === i+1}\"\n                class=\"media-count\">{{ i +1 }}</button>\n            </ng-container>\n          </div>\n        </div>\n\n        <img loading=\"lazy\" title=\"Click to open full screen\" (click)=\"openMedia(post.media[post.media[0].selectedIndex].fullPath)\"\n          class=\"selected-media\" [src]=\"post.media[post.media[0].selectedIndex].relativePath\">\n        <!-- <div *ngIf=\"selectedMediaBlob[selectedMediaIndex].format === 'image'\">\n          <img class=\"selected-media\" [src]=\"selectedMediaBlob[selectedMediaIndex].url\">\n        </div>\n\n        <div *ngIf=\"selectedMediaBlob[selectedMediaIndex].format === 'video'\">\n          <span><i>Video thumbnail</i></span>\n          <video class=\"selected-media\" [src]=\"selectedMediaBlob[selectedMediaIndex].url\"></video>\n        </div> -->\n      </div> <!-- end MEDIA -->\n\n      <div class=\"a-buttons noselect\" *ngIf=\"config.showOpt\">\n  \n        <div class=\"a-bttn-group\">\n          <div class=\"a-bttn-icon-box\">\n            <span title=\"Reply\" class=\"material-icons a-bttn-icon\" (click)=\"onReply()\">chat_bubble_outline</span>\n          </div>\n          <span class=\"a-bttn-count\">\n            {{ count.replies }} \n            <span class=\"notify\" style=\"color: orange\" *ngIf=\"config.publishing\">\n              ~ publishing\n              <span *ngIf=\"replyingProgress !== 0\">&nbsp;({{replyingProgress}})</span>\n            </span>\n            <span class=\"primary notify\" *ngIf=\"config.replied\">&nbsp;~ published</span>\n            <!-- <span class=\"primary notify\" *ngIf=\"config.deleted\">&nbsp;~ deleted</span> -->\n          </span>\n        </div>\n  \n        <div class=\"a-bttn-group noselect\">\n          <div class=\"a-bttn-icon-box\">\n            <span title=\"Like\" *ngIf=\"!config.liked\" class=\"material-icons a-bttn-icon\" (click)=\"onLike()\">favorite_border</span>\n            <span title=\"Dislike\" *ngIf=\"config.liked\" class=\"material-icons a-bttn-icon red\" (click)=\"onLike()\">favorite</span>\n          </div>\n          <span class=\"a-bttn-count\">\n            {{ count.likes }}\n          </span>\n        </div>\n  \n        <div class=\"a-bttn-group\">\n          <div class=\"a-bttn-icon-box a-bttn-icon\">\n            <span title=\"Share\" class=\"material-icons a-bttn-icon\" (click)=\"onShare()\">send</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</article>\n","import { Component, OnInit, Input } from '@angular/core';\nimport { PostsService } from '../posts.service';\nimport { first } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-posts-list',\n  templateUrl: './posts-list.component.html',\n  styleUrls: ['./posts-list.component.css']\n})\nexport class PostsListComponent implements OnInit {\n\n  _queryUrl: string;\n  @Input() showOptPosts = true;\n  @Input()\n    set queryUrl(queryUrl) {\n      this.loading = true;\n      this.postsService.getPostsList(queryUrl).pipe(first()).subscribe(res =>{\n        this.loading = false;\n        this.pageInfo = {\n          count: res.count,\n          pagination: res.pagination\n        };\n      });\n      this._queryUrl = queryUrl;\n    }\n    get queryUrl() {\n      return this._queryUrl;\n    }\n\n  postsList$;\n  pageInfo;\n\n  loading = true;\n  isLogged$;\n\n  constructor(\n    private postsService: PostsService,\n  ) { }\n\n  ngOnInit(): void {\n    this.postsList$ = this.postsService.posts$;\n  }\n}\n","<div class=\"container\">\n  <!-- <div *ngIf=\"pageInfo\">\n    <span>Count: {{ pageInfo.count }} | </span>\n    <span>Next page: {{ pageInfo.pagination.next.page }} | </span>\n    <span>Limit: {{  pageInfo.pagination.next.limit}}</span>\n    <hr>\n  </div> -->\n\n  <div *ngIf=\"loading\" style=\"padding: 2rem; text-align: center;\">\n    <h3>Searching posts...</h3>\n  </div>\n  <!-- Post Component List -->\n  <div class=\"posts-list\" *ngIf=\"postsList$ | async as postsList\">\n    <div *ngIf=\"!loading && postsList && postsList.length !== 0\">\n      <div class=\"border\" *ngFor=\"let post of postsList; let i=index\">\n        <app-post\n        [inputConfig]=\"{showOpt: showOptPosts, openPage: true}\"\n        [contextInfo]=\"{i:i, type:'list'}\"\n        [publishConfig]=\"{destination:0}\"\n        [deleteConfig]=\"{destination:1, parentIndex:i}\"\n        [post]=\"post\">\n        </app-post>\n      </div>\n    </div>\n\n    <div *ngIf=\"!loading && postsList.length === 0\" style=\"padding: 2rem; text-align: center;\">\n      <h3>No posts published yet</h3>   \n    </div>\n\n  </div>\n</div>\n","import { Component, OnInit } from '@angular/core';\nimport { PostsService } from '../posts.service';\nimport { LocationService } from 'src/app/services/location.service';\nimport { TokenService } from 'src/app/services/token.service';\nimport { ModalService } from 'src/app/shared/modal/modal.service';\nimport { ActivatedRoute } from '@angular/router';\nimport { concatMap, map, tap } from 'rxjs/operators';\nimport { of } from 'rxjs';\n\n@Component({\n  selector: 'app-posts-page',\n  templateUrl: './posts-page.component.html',\n  styleUrls: ['./posts-page.component.css']\n})\nexport class PostsPageComponent implements OnInit {\n  queryUrl;\n\n  postsList$;\n  pageInfo;\n\n  loading = true;\n  needsLogin;\n  isLogged;\n\n  constructor(\n    private postsService: PostsService,\n    private locationService: LocationService,\n    private token: TokenService,\n    private modalService: ModalService,\n    private route: ActivatedRoute\n  ) { }\n\n  ngOnInit(): void {\n    // const pages = {\n    //   explore: {\n    //     query: '/posts?parent[size]=0&childLevel=0&[limit]=10',\n    //     auth: false\n    //   },\n    //   home: {\n    //     query: '/posts/user',\n    //     auth: true\n    //   }\n    // };\n    this.token.user$.pipe(\n      concatMap((value, index) => (index !== 0 && index !== 1)\n        ? of(value).pipe(\n            tap(_ => this.postsService.refreshList())\n          )\n        : of(value)\n      ),\n    ).subscribe(isLogged => {\n      this.isLogged = isLogged;\n    });\n\n    const routeData = this.route.snapshot.data;\n    this.needsLogin = routeData['auth'];\n    this.queryUrl = routeData['query']\n    // this.route.params.subscribe(p => {\n    //   this.needsLogin = pages[p.page].auth;\n    //   this.queryUrl = pages[p.page].query;\n    // });\n  }\n\n  auth(component) {\n    const modal = {type: 'default', content: [\n      { title: 'Auth in order to post' },\n      { module: 'Auth', component, params: {navigateEnd: false} }\n    ]};\n    const location = {action: 'add', stack: [component]};\n    this.modalService.open(modal, location);\n  }\n}\n","<div class=\"container\">\n  <!-- Publish Component -->\n  <div *ngIf=\"isLogged; else notLogged\">\n    <app-post-publish\n      [destinationConfig]=\"{destination:1, parentIndex:0}\">\n    </app-post-publish>\n  </div>\n  \n  <ng-template #notLogged class=\"border auth-container\">\n    <div class=\"notLogged\">\n      <span class=\"auth-text\">In order to post you need to be logged in!</span>\n      <div class=\"bttn-group\">\n        <button class=\"bttn solid-bttn\" (click)=\"auth('Login')\">Login</button>\n        &nbsp;or&nbsp;\n        <button class=\"bttn solid-bttn\" (click)=\"auth('Register')\">Register</button>\n      </div>\n    </div>\n  </ng-template>\n\n  <ng-container *ngIf=\"!needsLogin && needsLogin !== null || isLogged\">\n    <app-posts-list [queryUrl]=\"queryUrl\"></app-posts-list>\n  </ng-container>\n</div>\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\n// Components\nimport { PostsComponent } from './posts.component'; // Main\nimport { PostComponent } from './post/post.component';\nimport { PostPublishComponent } from './post-publish/post-publish.component';\nimport { PostsListComponent } from './posts-list/posts-list.component';\nimport { PostsPageComponent } from './posts-page/posts-page.component';\nimport { PostArticleComponent } from './post-article/post-article.component';\n\nconst routes: Routes = [\n  { \n    path: 'post/:postId',\n    component: PostArticleComponent,\n  },\n  { \n    path: 'explore', \n    component: PostsPageComponent,\n    data: {\n      page: 'explore',\n      query: '/posts?parent[size]=0&childLevel=0&[limit]=10',\n      auth: false\n    }\n  },\n  { \n    path: 'home', \n    component: PostsPageComponent,\n    data: {\n      path: 'home',\n      query: '/posts/user',\n      auth: true\n    }\n  },\n  {\n    path: '',\n    redirectTo: '/explore',\n    pathMatch: 'full'\n  },\n  {\n    path: '**',\n    redirectTo: '/explore',\n    pathMatch: 'full'\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class PostsRoutingModule { }\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-posts',\n  templateUrl: './posts.component.html',\n  styleUrls: ['./posts.component.css']\n})\nexport class PostsComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","<router-outlet></router-outlet>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { PostsRoutingModule } from './posts-routing.module';\n\nimport { PostsComponent } from './posts.component';\nimport { PostComponent } from './post/post.component';\nimport { PostPublishComponent } from './post-publish/post-publish.component';\nimport { PostsListComponent } from './posts-list/posts-list.component';\nimport { PostArticleComponent } from './post-article/post-article.component';\n\nimport { ModalModule } from 'src/app/shared/modal/modal.module';\n// import { ProfileModule } from 'src/app/modules/profile/profile.module';\n// import { TooltipModule } from 'src/app/shared/tooltip/tooltip.module';\n\nimport { PipesModule } from 'src/app/pipes/pipes.module';\nimport { PostsPageComponent } from './posts-page/posts-page.component';\n\n\n@NgModule({\n  declarations: [\n    PostComponent,\n    PostPublishComponent,\n    PostsListComponent,\n    PostArticleComponent,\n    PostsComponent,\n    PostsPageComponent\n  ],\n  imports: [\n    CommonModule,\n    PostsRoutingModule,\n    ModalModule,\n    PipesModule,\n  ],\n  exports: [\n    PostComponent,\n    PostPublishComponent,\n    PostsListComponent\n  ]\n})\nexport class PostsModule { \n  static components = {\n    PostComponent,\n    PostPublishComponent,\n    PostsListComponent\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n  name: 'dateAgo'\n})\nexport class DateAgoPipe implements PipeTransform {\n\n  transform(value: any, args?: any): any {\n    if (value) {\n      const seconds = Math.floor((+new Date() - +new Date(value)) / 1000);\n      if (seconds < 29) // less than 30 seconds ago will show as 'Just now'\n        return 'Just now';\n      const intervals = {\n        'year': 31536000,\n        'month': 2592000,\n        'week': 604800,\n        'day': 86400,\n        'hour': 3600,\n        'minute': 60,\n        'second': 1\n      };\n      let counter;\n      for (const i in intervals) {\n        counter = Math.floor(seconds / intervals[i]);\n        if (counter > 0)\n          if (counter === 1) {\n            return counter + ' ' + i + ' ago'; // singular (1 day ago)\n          } else {\n            return counter + ' ' + i + 's ago'; // plural (2 days ago)\n          }\n      }\n    }\n    return value;\n  }\n\n}\n","import { NgModule } from '@angular/core';\n\nimport { DateAgoPipe } from './date-ago.pipe';\nimport { UserPipe } from './user.pipe';\n\n@NgModule({\n  declarations: [\n    DateAgoPipe, \n    UserPipe\n  ],\n  exports: [\n    DateAgoPipe,\n    UserPipe\n  ]\n})\nexport class PipesModule { }\n","import { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n  name: 'user'\n})\nexport class UserPipe implements PipeTransform {\n\n  transform(value: unknown, ...args: unknown[]): unknown {\n    return '@' + value;\n  }\n\n}\n"]}