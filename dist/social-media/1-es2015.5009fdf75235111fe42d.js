(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"/6QR":function(t,e,n){"use strict";n.d(e,"a",(function(){return E}));var i=n("fXoL"),o=n("NloB"),s=n("Kszi"),c=n("rj1t"),r=n("yHma"),a=n("N3Xk"),l=n("ofXK");const d=["obj"],p=["wrapper"],b=["animation"],g=["*"];let u=(()=>{class t{constructor(t,e){this.modalService=t,this.renderer=e,this.clicked=new i.n}set trigger(t){t.addEventListener("mouseenter",this.checkDelay.bind(this)),t.addEventListener("mouseleave",this.closeTooltip.bind(this)),t.addEventListener("click",this.onClick.bind(this))}ngOnInit(){}ngAfterViewInit(){this.objDim=this.obj.nativeElement.getBoundingClientRect(),this.renderer.setStyle(this.wrapper.nativeElement,"width",this.objDim.width+"px"),this.renderer.setStyle(this.wrapper.nativeElement,"height",this.objDim.height+"px"),this.wrapper.nativeElement.addEventListener("mouseenter",this.checkDelay.bind(this)),this.wrapper.nativeElement.addEventListener("mouseleave",this.closeTooltip.bind(this)),this.wrapper.nativeElement.addEventListener("click",this.onClick.bind(this))}onClick(){clearTimeout(this.time),this.clicked.emit(this.params.user._id)}checkDelay(){this.animation.nativeElement.className="loading-avatar",clearTimeout(this.time),this.time=setTimeout(()=>this.openTooltip(),1500)}openTooltip(){this.modalService.closeByType("tooltip"),this.modalService.open({type:"tooltip",content:[{module:"Profile",component:"ProfileCard",params:this.params}],params:{objDimensions:this.objDim},keepOpened:!0},{action:"set",stack:["@"+this.params.user.username]},t=>{this.closeTooltip()})}closeTooltip(){this.renderer.removeClass(this.animation.nativeElement,"loading-avatar"),clearTimeout(this.time)}}return t.\u0275fac=function(e){return new(e||t)(i.Jb(s.a),i.Jb(i.D))},t.\u0275cmp=i.Db({type:t,selectors:[["tooltip-wrapper"]],contentQueries:function(t,e,n){var o;1&t&&i.Cb(n,d,!0),2&t&&i.jc(o=i.Xb())&&(e.obj=o.first)},viewQuery:function(t,e){var n;1&t&&(i.yc(p,!0),i.yc(b,!0)),2&t&&(i.jc(n=i.Xb())&&(e.wrapper=n.first),i.jc(n=i.Xb())&&(e.animation=n.first))},inputs:{params:"params",trigger:"trigger"},outputs:{clicked:"clicked"},ngContentSelectors:g,decls:5,vars:0,consts:[["animation",""],[1,"wrapper"],["wrapper",""]],template:function(t,e){1&t&&(i.ec(),i.dc(0),i.Kb(1,"div",null,0),i.Kb(3,"div",1,2))},styles:[".wrapper[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,0);display:block;left:0;cursor:pointer;z-index:3}.loading-avatar[_ngcontent-%COMP%], .wrapper[_ngcontent-%COMP%]{position:absolute;border-radius:50%;top:0}.loading-avatar[_ngcontent-%COMP%]{z-index:2;width:3.8rem;height:3.8rem;background-color:rgba(23,191,99,.589);-webkit-animation:example 1.5s linear .1s;animation:example 1.5s linear .1s;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}@-webkit-keyframes example{0%{width:3.8rem;height:3.8rem;left:0;top:0}to{width:0;height:0;left:1.9rem;top:1.9rem}}@keyframes example{0%{width:3.8rem;height:3.8rem;left:0;top:0}to{width:0;height:0;left:1.9rem;top:1.9rem}}"]}),t})();var f=n("6Kw5");const h=["triggerTooltip"];function m(t,e){1&t&&i.Kb(0,"div",17)}const v=function(t){return{user:t}};function O(t,e){if(1&t){const t=i.Pb();i.Mb(0),i.Ob(1,"tooltip-wrapper",19),i.Wb("clicked",(function(e){return i.nc(t),i.ac(3).goToUser(e)})),i.Kb(2,"img",20,21),i.Nb(),i.Lb()}if(2&t){i.ac(2);const t=i.kc(13),e=i.ac();i.zb(1),i.fc("params",i.hc(3,v,e.post.owner))("trigger",t),i.zb(1),i.fc("src",e.post.owner.avatar.relativePath,i.pc)}}function y(t,e){if(1&t&&(i.Mb(0),i.Kb(1,"img",20),i.Lb()),2&t){const t=i.ac(3);i.zb(1),i.fc("src",t.post.owner.avatar.relativePath,i.pc)}}function P(t,e){if(1&t&&(i.Ob(0,"div",18),i.sc(1,O,4,5,"ng-container",7),i.sc(2,y,2,1,"ng-container",7),i.Nb()),2&t){const t=i.ac(2);i.zb(1),i.fc("ngIf",t.config.showOpt),i.zb(1),i.fc("ngIf",!t.config.showOpt)}}function x(t,e){1&t&&(i.Ob(0,"div"),i.Kb(1,"img",22),i.Nb())}function C(t,e){if(1&t){const t=i.Pb();i.Ob(0,"div",23),i.Ob(1,"span",24),i.Wb("click",(function(){return i.nc(t),i.ac(2).onDelete()})),i.uc(2,"clear"),i.Nb(),i.Nb()}}function M(t,e){1&t&&(i.Ob(0,"span"),i.uc(1,"\xa0>\xa0"),i.Nb())}function w(t,e){if(1&t){const t=i.Pb();i.Ob(0,"div",27),i.Ob(1,"span",28),i.Wb("click",(function(){i.nc(t);const n=e.$implicit;return i.ac(3).goToUser(n)})),i.uc(2),i.Nb(),i.sc(3,M,2,0,"span",7),i.Nb()}if(2&t){const t=e.$implicit,n=e.index,o=i.ac(3);i.zb(2),i.vc(t),i.zb(1),i.fc("ngIf",n!==o.post.replyRef.length-1)}}function k(t,e){if(1&t&&(i.Ob(0,"div",25),i.Ob(1,"span"),i.uc(2,"Replying to\xa0"),i.Nb(),i.sc(3,w,4,2,"div",26),i.Nb()),2&t){const t=i.ac(2);i.zb(3),i.fc("ngForOf",t.post.replyRef)}}const I=function(t){return{"current-selected-media":t}};function _(t,e){if(1&t){const t=i.Pb();i.Mb(0),i.Ob(1,"button",32),i.Wb("click",(function(){i.nc(t);const n=e.index;return i.ac(4).post.media[0].selectedIndex=n+1})),i.uc(2),i.Nb(),i.Lb()}if(2&t){const t=e.index,n=i.ac(4);i.zb(1),i.fc("title","Change to image ".concat(t+1))("ngClass",i.hc(3,I,n.post.media[0].selectedIndex===t+1)),i.zb(1),i.vc(t+1)}}function N(t,e){if(1&t&&(i.Ob(0,"div"),i.sc(1,_,3,5,"ng-container",31),i.Nb()),2&t){const t=i.ac(3);i.zb(1),i.fc("ngForOf",t.post.media.slice(1))}}function z(t,e){if(1&t){const t=i.Pb();i.Ob(0,"div"),i.Ob(1,"div",29),i.sc(2,N,2,1,"div",7),i.Nb(),i.Ob(3,"img",30),i.Wb("click",(function(){i.nc(t);const e=i.ac(2);return e.openMedia(e.post.media[e.post.media[0].selectedIndex].fullPath)})),i.Nb(),i.Nb()}if(2&t){const t=i.ac(2);i.zb(2),i.fc("ngIf",t.post.media.length>2),i.zb(1),i.fc("src",t.post.media[t.post.media[0].selectedIndex].relativePath,i.pc)}}function S(t,e){if(1&t&&(i.Ob(0,"span"),i.uc(1),i.Nb()),2&t){const t=i.ac(4);i.zb(1),i.wc("\xa0(",t.replyingProgress,")")}}function L(t,e){if(1&t&&(i.Ob(0,"span",45),i.uc(1," ~ publishing "),i.sc(2,S,2,1,"span",7),i.Nb()),2&t){const t=i.ac(3);i.zb(2),i.fc("ngIf",0!==t.replyingProgress)}}function R(t,e){1&t&&(i.Ob(0,"span",46),i.uc(1,"\xa0~ published"),i.Nb())}function j(t,e){if(1&t){const t=i.Pb();i.Ob(0,"span",47),i.Wb("click",(function(){return i.nc(t),i.ac(3).onLike()})),i.uc(1,"favorite_border"),i.Nb()}}function D(t,e){if(1&t){const t=i.Pb();i.Ob(0,"span",48),i.Wb("click",(function(){return i.nc(t),i.ac(3).onLike()})),i.uc(1,"favorite"),i.Nb()}}function K(t,e){if(1&t){const t=i.Pb();i.Ob(0,"div",33),i.Ob(1,"div",34),i.Ob(2,"div",35),i.Ob(3,"span",36),i.Wb("click",(function(){return i.nc(t),i.ac(2).onReply()})),i.uc(4,"chat_bubble_outline"),i.Nb(),i.Nb(),i.Ob(5,"span",37),i.uc(6),i.sc(7,L,3,1,"span",38),i.sc(8,R,2,0,"span",39),i.Nb(),i.Nb(),i.Ob(9,"div",40),i.Ob(10,"div",35),i.sc(11,j,2,0,"span",41),i.sc(12,D,2,0,"span",42),i.Nb(),i.Ob(13,"span",37),i.uc(14),i.Nb(),i.Nb(),i.Ob(15,"div",34),i.Ob(16,"div",43),i.Ob(17,"span",44),i.Wb("click",(function(){return i.nc(t),i.ac(2).onShare()})),i.uc(18,"send"),i.Nb(),i.Nb(),i.Nb(),i.Nb()}if(2&t){const t=i.ac(2);i.zb(6),i.wc(" ",t.count.replies," "),i.zb(1),i.fc("ngIf",t.config.publishing),i.zb(1),i.fc("ngIf",t.config.replied),i.zb(3),i.fc("ngIf",!t.config.liked),i.zb(1),i.fc("ngIf",t.config.liked),i.zb(2),i.wc(" ",t.count.likes," ")}}const U=function(){return{filter:"blur(1.5px)"}};function F(t,e){if(1&t){const t=i.Pb();i.Ob(0,"article",1),i.Ob(1,"div",2),i.Wb("click",(function(){return i.nc(t),i.ac().openReplyPage()})),i.Nb(),i.Ob(2,"div",3),i.Ob(3,"div",4),i.sc(4,m,1,0,"div",5),i.sc(5,P,3,2,"div",6),i.sc(6,x,2,0,"div",7),i.Nb(),i.Ob(7,"div",8),i.Ob(8,"div",9),i.Ob(9,"span",10),i.Ob(10,"span"),i.Ob(11,"div"),i.Ob(12,"span",11,12),i.uc(14),i.Nb(),i.Ob(15,"span"),i.uc(16),i.bc(17,"dateAgo"),i.Nb(),i.Nb(),i.Nb(),i.Nb(),i.sc(18,C,3,0,"div",13),i.Nb(),i.sc(19,k,4,1,"div",14),i.Ob(20,"div",15),i.uc(21),i.Nb(),i.sc(22,z,4,2,"div",7),i.sc(23,K,19,6,"div",16),i.Nb(),i.Nb(),i.Nb()}if(2&t){const t=i.ac();i.fc("ngClass",t.config.openPage&&"select-hover")("ngStyle",t.config.loading&&i.gc(14,U)),i.zb(4),i.fc("ngIf",t.config.thread),i.zb(1),i.fc("ngIf",t.post.owner),i.zb(1),i.fc("ngIf",t.config.empty),i.zb(8),i.wc(" @",t.post.owner.username," "),i.zb(2),i.wc(" - ",i.cc(17,12,t.post.createdAt),""),i.zb(2),i.fc("ngIf",t.config.owner&&t.config.showOpt&&!t.config.loading),i.zb(1),i.fc("ngIf",t.post.replyRef&&0!==t.post.replyRef.length),i.zb(2),i.wc(" ",t.post.text," "),i.zb(1),i.fc("ngIf",t.post.media&&0!==t.post.media.length),i.zb(1),i.fc("ngIf",t.config.showOpt)}}let E=(()=>{class t{constructor(t,e,n,i,o,s){this.postsService=t,this.modalService=e,this.token=n,this.locationService=i,this.navbarService=o,this.renderer=s,this.contextInfo={i:0,type:void 0},this.config={showOpt:!0,openPage:!0,owner:!1,replied:!1,publishing:!1,deleted:!1,liked:!1,shared:!1,reported:!1,thread:!1,tooltip:!0,loading:!1,empty:!1},this.count={replies:0,likes:0,shares:0},this.mediaSelIdx=0,this.replyingProgress=0}set inputConfig(t){this.config=Object.assign(this.config,t),this._inputConfig=t}get inputConfig(){return this._inputConfig||{}}set post(t){if(t.media&&0!==t.media.length&&!t.media[0].selectedIndex&&t.media.unshift({selectedIndex:1}),this.config.empty)t._id="loading...",t.replyRef=Array(this.contextInfo.i).fill("???"),this._post=t;else if(t._id)this.countData(t),this._post=this.auth(t,this.token.getUserId()),this._post=Object.assign({},t);else{const e=this.token.getUserData();t.owner=(({id:t,name:e,username:n,avatar:i})=>({_id:t,name:e,username:n,avatar:i}))(e),this.config.owner=!0,this.config.loading=!0,this.config.thread=!1,this._post=t}}get post(){return this._post}ngOnInit(){}ngOnChanges(t){var e,n,i,o;const s=(null===(n=null===(e=t.post)||void 0===e?void 0:e.previousValue)||void 0===n?void 0:n._id)!==(null===(i=t.post)||void 0===i?void 0:i.currentValue._id);!(null===(o=t.post)||void 0===o?void 0:o.firstChange)&&s&&(this.config=Object.assign(this.config,this._inputConfig),this._post.media&&0!==this._post.media.length&&!this._post.media.selectedIndex&&this._post.media.unshift({selectedIndex:1}),this.config.replied=!1,this.config.deleted=!1)}countData(t){var e;this.count={replies:(null===(e=t.child)||void 0===e?void 0:e.length)||0,likes:t.likes,shares:0}}auth(t,e){return this.config.owner=t.owner._id===e&&(!this.inputConfig.hasOwnProperty("owner")||this.inputConfig.owner),this.config.liked=t.whoLiked.includes(e),e&&(t.confirm={owner:this.config.owner,liked:this.config.liked}),t}goToUser(t){this.config.showOpt&&this.navbarService.go("/u/"+t)}onReply(){this.checkAuth("In order to reply a post you need to be logged in")&&this.modalService.open({type:"default",content:[{module:"Posts",component:"PostPublish",params:{postReply:this.post,destinationConfig:this.publishConfig}}]},{action:"add",stack:["Reply"]},t=>{var e;t?t&&t.hasOwnProperty("progress")?this.replyingProgress=t.progress:(this.count.replies+=1,this.config.publishing=!1,this.config.replied=!0,this.replyingProgress=0,["list","reply"].includes(null===(e=this.contextInfo)||void 0===e?void 0:e.type)&&this.post.child.push(t)):(this.config.replied=!1,this.config.publishing=!0,this.locationService.removeItemFromStack(2),this.locationService.addItemToStack(["Publishing reply..."]))})}onLike(){this.checkAuth("In order to like a post you need to be logged in")&&(this.config.liked?(this.config.liked=!1,this.count.likes-=1):(this.config.liked=!0,this.count.likes+=1),this.postsService.likePost(this.post._id))}onDelete(){this.postsService.deletePost(this.post._id,this.deleteConfig)}openReplyPage(){this.config.openPage&&(this.modalService.forceClose(),this.postsService.setMainPost(Object.assign({},this.post),this.contextInfo),this.navbarService.go("/post/"+this.post._id))}onShare(){const t=`${window.location.host}/p/${this.post._id}`;this.modalService.open({type:"default",content:[{title:"Share a post"},{html:`<p align="center">${t}</p>`}]},{action:"add",stack:["Share"]})}checkAuth(t){return!!this.token.isLogged()||(this.modalService.open({type:"default",content:[{title:t},{module:"Auth",component:"Login",params:{navigateEnd:!1}}]},{action:"add",stack:["Login"]}),!1)}openMedia(t){this.modalService.open({type:"extended",content:[{title:"Media from @"+this.post.owner.username},{html:`<img width="100%" src="${t}">`}]},{action:"add",stack:["Media"]})}}return t.\u0275fac=function(e){return new(e||t)(i.Jb(o.a),i.Jb(s.a),i.Jb(c.a),i.Jb(r.a),i.Jb(a.a),i.Jb(i.D))},t.\u0275cmp=i.Db({type:t,selectors:[["app-post"]],viewQuery:function(t,e){var n;1&t&&i.yc(h,!0),2&t&&i.jc(n=i.Xb())&&(e.triggerTooltip=n.first)},inputs:{contextInfo:"contextInfo",publishConfig:"publishConfig",deleteConfig:"deleteConfig",inputConfig:"inputConfig",post:"post"},features:[i.xb],decls:1,vars:1,consts:[[3,"ngClass","ngStyle",4,"ngIf"],[3,"ngClass","ngStyle"],[1,"route",3,"click"],[1,"post"],[1,"a-profile"],["class","thread-line",4,"ngIf"],["class","a-profile-avatar",4,"ngIf"],[4,"ngIf"],[1,"a-content"],[1,"a-acc"],[1,"a-username"],[1,"aroba"],["triggerTooltip",""],["class","delete-bttn","style","margin-left: auto",4,"ngIf"],["class","replyRef",4,"ngIf"],[1,"a-text"],["class","a-buttons noselect",4,"ngIf"],[1,"thread-line"],[1,"a-profile-avatar"],[3,"params","trigger","clicked"],[1,"a-avatar",3,"src"],["obj",""],[1,"a-avatar",2,"background-color","lightgray"],[1,"delete-bttn",2,"margin-left","auto"],["title","Delete post",1,"material-icons",3,"click"],[1,"replyRef"],["class","arobas",4,"ngFor","ngForOf"],[1,"arobas"],[1,"aroba",3,"click"],[1,"count-container"],["loading","lazy","title","Click to open full screen",1,"selected-media",3,"src","click"],[4,"ngFor","ngForOf"],[1,"media-count",3,"title","ngClass","click"],[1,"a-buttons","noselect"],[1,"a-bttn-group"],[1,"a-bttn-icon-box"],["title","Reply",1,"material-icons","a-bttn-icon",3,"click"],[1,"a-bttn-count"],["class","notify","style","color: orange",4,"ngIf"],["class","primary notify",4,"ngIf"],[1,"a-bttn-group","noselect"],["title","Like","class","material-icons a-bttn-icon",3,"click",4,"ngIf"],["title","Dislike","class","material-icons a-bttn-icon red",3,"click",4,"ngIf"],[1,"a-bttn-icon-box","a-bttn-icon"],["title","Share",1,"material-icons","a-bttn-icon",3,"click"],[1,"notify",2,"color","orange"],[1,"primary","notify"],["title","Like",1,"material-icons","a-bttn-icon",3,"click"],["title","Dislike",1,"material-icons","a-bttn-icon","red",3,"click"]],template:function(t,e){1&t&&i.sc(0,F,24,15,"article",0),2&t&&i.fc("ngIf",e.post)},directives:[l.k,l.i,l.l,u,l.j],pipes:[f.a],styles:["article[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:relative;padding-bottom:.5rem}.select-hover[_ngcontent-%COMP%]:hover{background-color:#111d29}.route[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;cursor:pointer}.bar-container[_ngcontent-%COMP%]{margin:10px auto;width:80%;text-align:center}.progress[_ngcontent-%COMP%]{padding:3px;border-radius:12px;background:rgba(0,0,0,.25)}.progress-bar[_ngcontent-%COMP%]{height:.2rem;border-radius:30px;width:85%;background-color:rgba(71,239,99,.47)}.material-icons[_ngcontent-%COMP%]{cursor:pointer;position:relative}.replyRef[_ngcontent-%COMP%]{margin-bottom:.3rem;color:var(--secondary-color);font-size:.8rem}.notify[_ngcontent-%COMP%]{position:absolute}.arobas[_ngcontent-%COMP%]{display:inline-block}.aroba[_ngcontent-%COMP%]{color:#06b8ff;cursor:pointer;position:relative;z-index:1}.aroba[_ngcontent-%COMP%]:hover{color:var(--primary-color)}.post[_ngcontent-%COMP%]{padding:1rem 1rem 0}.a-acc[_ngcontent-%COMP%], .post[_ngcontent-%COMP%]{display:flex}.a-name[_ngcontent-%COMP%]{color:var(--text-color);font-weight:700;margin-right:.3rem}.a-name[_ngcontent-%COMP%], .a-username[_ngcontent-%COMP%]{font-size:1rem;cursor:pointer}.a-username[_ngcontent-%COMP%]{color:#8899a6}.a-profile[_ngcontent-%COMP%]{display:flex;flex-direction:column}.a-avatar[_ngcontent-%COMP%], .a-profile-avatar[_ngcontent-%COMP%]{position:relative}.a-avatar[_ngcontent-%COMP%]{width:3.4rem;height:3.4rem;border-radius:50%;background-color:var(--hover-color);padding:.2rem;cursor:pointer;z-index:1}.a-content[_ngcontent-%COMP%]{margin-left:.8rem;flex:1;display:flex;flex-direction:column}.a-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin:.3rem 0;flex:1}.a-bttn-group[_ngcontent-%COMP%]{width:100%;flex-direction:row;margin-right:auto;cursor:pointer}.a-bttn-group[_ngcontent-%COMP%], .a-bttn-icon-box[_ngcontent-%COMP%]{display:flex;align-items:center}.a-bttn-icon-box[_ngcontent-%COMP%]{padding:.7rem;border-radius:50%}.a-bttn-count[_ngcontent-%COMP%], .a-bttn-icon[_ngcontent-%COMP%]{color:var(--secondary-color);z-index:1}.a-bttn-icon-box[_ngcontent-%COMP%]:hover{background-color:var(--hover-empty-color)}.a-bttn-icon-box[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%], .a-bttn-icon-box[_ngcontent-%COMP%]:hover ~ .a-bttn-count[_ngcontent-%COMP%]{color:var(--primary-color)}.a-text[_ngcontent-%COMP%]{position:relative}.comment[_ngcontent-%COMP%]{padding:1rem 1rem 0}.thread-line[_ngcontent-%COMP%]{border-left:3px solid #8899a6;margin-left:30px;height:100%;margin-top:2rem;position:absolute}.red[_ngcontent-%COMP%]{color:#ff6a6a;border:0}.selected-media[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:30px;position:relative;cursor:pointer;transition:transform .2s}.selected-media[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.media-count[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;padding:.5rem 1rem;border:0;border-radius:500px;text-align:center;display:inline;cursor:pointer;background-color:var(--primary-color);color:var(--text-color);margin-right:1rem;position:relative}.media-count[_ngcontent-%COMP%]:hover:not(.current-selected-media){background-color:var(--hover-solid-color)}.count-container[_ngcontent-%COMP%]{margin:1rem 0;display:flex;flex-direction:row;align-items:center}.current-selected-media[_ngcontent-%COMP%]{background-color:var(--hover-empty-color)}.delete-bttn[_ngcontent-%COMP%]{margin-left:auto;cursor:pointer}"]}),t})()},"6Kw5":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n("fXoL");let o=(()=>{class t{transform(t,e){if(t){const e=Math.floor((+new Date-+new Date(t))/1e3);if(e<29)return"Just now";const n={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};let i;for(const t in n)if(i=Math.floor(e/n[t]),i>0)return 1===i?i+" "+t+" ago":i+" "+t+"s ago"}return t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=i.Ib({name:"dateAgo",type:t,pure:!0}),t})()},OUel:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var i=n("SxV6"),o=n("fXoL"),s=n("NloB"),c=n("ofXK"),r=n("/6QR");function a(t,e){1&t&&(o.Ob(0,"div",3),o.Ob(1,"h3"),o.uc(2,"Searching posts..."),o.Nb(),o.Nb())}const l=function(t){return{showOpt:t,openPage:!0}},d=function(t){return{i:t,type:"list"}},p=function(){return{destination:0}},b=function(t){return{destination:1,parentIndex:t}};function g(t,e){if(1&t&&(o.Ob(0,"div",7),o.Kb(1,"app-post",8),o.Nb()),2&t){const t=e.$implicit,n=e.index,i=o.ac(3);o.zb(1),o.fc("inputConfig",o.hc(5,l,i.showOptPosts))("contextInfo",o.hc(7,d,n))("publishConfig",o.gc(9,p))("deleteConfig",o.hc(10,b,n))("post",t)}}function u(t,e){if(1&t&&(o.Ob(0,"div"),o.sc(1,g,2,12,"div",6),o.Nb()),2&t){const t=o.ac().ngIf;o.zb(1),o.fc("ngForOf",t)}}function f(t,e){1&t&&(o.Ob(0,"div",3),o.Ob(1,"h3"),o.uc(2,"No posts published yet"),o.Nb(),o.Nb())}function h(t,e){if(1&t&&(o.Ob(0,"div",4),o.sc(1,u,2,1,"div",5),o.sc(2,f,3,0,"div",1),o.Nb()),2&t){const t=e.ngIf,n=o.ac();o.zb(1),o.fc("ngIf",!n.loading&&t&&0!==t.length),o.zb(1),o.fc("ngIf",!n.loading&&0===t.length)}}let m=(()=>{class t{constructor(t){this.postsService=t,this.showOptPosts=!0,this.loading=!0}set queryUrl(t){this.loading=!0,this.postsService.getPostsList(t).pipe(Object(i.a)()).subscribe(t=>{this.loading=!1,this.pageInfo={count:t.count,pagination:t.pagination}}),this._queryUrl=t}get queryUrl(){return this._queryUrl}ngOnInit(){this.postsList$=this.postsService.posts$}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(s.a))},t.\u0275cmp=o.Db({type:t,selectors:[["app-posts-list"]],inputs:{showOptPosts:"showOptPosts",queryUrl:"queryUrl"},decls:4,vars:4,consts:[[1,"container"],["style","padding: 2rem; text-align: center;",4,"ngIf"],["class","posts-list",4,"ngIf"],[2,"padding","2rem","text-align","center"],[1,"posts-list"],[4,"ngIf"],["class","border",4,"ngFor","ngForOf"],[1,"border"],[3,"inputConfig","contextInfo","publishConfig","deleteConfig","post"]],template:function(t,e){1&t&&(o.Ob(0,"div",0),o.sc(1,a,3,0,"div",1),o.sc(2,h,3,2,"div",2),o.bc(3,"async"),o.Nb()),2&t&&(o.zb(1),o.fc("ngIf",e.loading),o.zb(1),o.fc("ngIf",o.cc(3,2,e.postsList$)))},directives:[c.k,c.j,r.a],pipes:[c.b],styles:[".container[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column}.border[_ngcontent-%COMP%]{border-bottom:1.5px solid var(--primary-color)}.auth-container[_ngcontent-%COMP%]{padding:1rem;justify-content:center}.auth-container[_ngcontent-%COMP%], .notLogged[_ngcontent-%COMP%]{display:flex;align-items:center}.notLogged[_ngcontent-%COMP%]{flex-direction:column;margin:0 auto}.bttn[_ngcontent-%COMP%]{border:0;font-size:1.1rem;font-weight:700;padding:.6rem 3rem;border-radius:500px;text-align:center;display:inline;cursor:pointer;background-color:var(--primary-color)}.bttn[_ngcontent-%COMP%]:hover{background-color:#15ac59}.auth-text[_ngcontent-%COMP%]{font-size:1.3rem;padding-bottom:.5rem}"]}),t})()},iTUp:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n("fXoL");let o=(()=>{class t{}return t.\u0275mod=i.Hb({type:t}),t.\u0275inj=i.Gb({factory:function(e){return new(e||t)}}),t})()},xZLo:function(t,e,n){"use strict";n.r(e),n.d(e,"PostsModule",(function(){return bt}));var i=n("ofXK"),o=n("tyNb"),s=n("bOdf"),c=n("vkgz"),r=n("LRne"),a=n("fXoL"),l=n("NloB"),d=n("yHma"),p=n("rj1t"),b=n("Kszi"),g=n("BFxc"),u=n("lJxs"),f=n("/6QR");const h=["postInput"],m=["mediaSelect"],v=function(){return{showOpt:!1,thread:!0,openPage:!1}};function O(t,e){if(1&t&&(a.Ob(0,"div",20),a.Kb(1,"app-post",21),a.Nb()),2&t){const t=a.ac();a.zb(1),a.fc("inputConfig",a.gc(2,v))("post",t.postReply)}}function y(t,e){if(1&t&&(a.Ob(0,"div",22),a.Ob(1,"span"),a.uc(2,"Replying to\xa0"),a.Nb(),a.Ob(3,"span",23),a.uc(4),a.Nb(),a.Nb()),2&t){const t=a.ac();a.zb(4),a.wc("@",t.postReply.owner.username,"")}}function P(t,e){if(1&t&&(a.Zb(),a.Yb(),a.Ob(0,"div",24),a.uc(1),a.Nb()),2&t){const t=a.ac();a.zb(1),a.wc(" Uploading ",t.uploadProgress,"% ")}}const x=function(t){return{"current-selected-media":t}};function C(t,e){if(1&t){const t=a.Pb();a.Mb(0),a.Ob(1,"button",30),a.Wb("click",(function(){a.nc(t);const n=e.index;return a.ac(3).selectedMediaIndex=n})),a.uc(2),a.Nb(),a.Lb()}if(2&t){const t=e.index,n=a.ac(3);a.zb(1),a.fc("ngClass",a.hc(2,x,n.selectedMediaIndex===t)),a.zb(1),a.vc(t+1)}}function M(t,e){if(1&t&&(a.Ob(0,"div"),a.sc(1,C,3,4,"ng-container",29),a.Nb()),2&t){const t=a.ac(2);a.zb(1),a.fc("ngForOf",t.selectedMediaBlob)}}function w(t,e){if(1&t&&(a.Ob(0,"div"),a.Kb(1,"img",31),a.Nb()),2&t){const t=a.ac(2);a.zb(1),a.fc("src",t.selectedMediaBlob[t.selectedMediaIndex].url,a.pc)}}function k(t,e){if(1&t&&(a.Ob(0,"div"),a.Ob(1,"span"),a.Ob(2,"i"),a.uc(3,"Video thumbnail"),a.Nb(),a.Nb(),a.Kb(4,"video",31),a.Nb()),2&t){const t=a.ac(2);a.zb(4),a.fc("src",t.selectedMediaBlob[t.selectedMediaIndex].url,a.pc)}}function I(t,e){if(1&t){const t=a.Pb();a.Ob(0,"div",25),a.Ob(1,"div",26),a.sc(2,M,2,1,"div",27),a.Ob(3,"div",28),a.Wb("click",(function(){a.nc(t);const e=a.ac();return e.onCancelSelectedMedia(e.selectedMediaIndex)})),a.uc(4),a.Nb(),a.Nb(),a.sc(5,w,2,1,"div",27),a.sc(6,k,5,1,"div",27),a.Nb()}if(2&t){const t=a.ac();a.zb(2),a.fc("ngIf",t.selectedMediaBlob.length>1),a.zb(2),a.wc("Remove media ",t.selectedMediaIndex+1,""),a.zb(1),a.fc("ngIf","image"===(null==t.selectedMediaBlob[t.selectedMediaIndex]?null:t.selectedMediaBlob[t.selectedMediaIndex].format)),a.zb(1),a.fc("ngIf","video"===(null==t.selectedMediaBlob[t.selectedMediaIndex]?null:t.selectedMediaBlob[t.selectedMediaIndex].format))}}let _=(()=>{class t{constructor(t,e,n){this.postsService=t,this.modalService=e,this.token=n,this.postReply=null,this.destinationConfig=null,this.selectedMedia=[],this.selectedMediaBlob=[],this.selectedMediaIndex=-1,this.showUploadProgress=!1,this.uploadProgress=0}ngOnInit(){this.user=this.token.getUserData()}publishPost(){const t=this.postInput.nativeElement.innerText;if(!t)return;this.modalService.emitResponse(!1,!1);const e={text:t,media:0!==this.selectedMedia.length?this.selectedMedia:null};this.publisher$=(()=>this.postReply?this.postsService.replyPost(this.postReply._id,e,this.destinationConfig):this.postsService.publishPost(e,this.destinationConfig))().subscribe(t=>{t.progress?(this.showUploadProgress=!0,this.uploadProgress=t.progress):this.showUploadProgress=!1,this.modalService.emitResponse(!t.hasOwnProperty("progress"),t)}),this.clear()}clear(){this.postInput.nativeElement.innerText="",this.mediaSelect.nativeElement.value="",this.selectedMedia=[],this.selectedMediaBlob=[],this.selectedMediaIndex=0}onMediaSelect(t){if(this.selectedMedia.length+t.target.files.length>5)this.modalService.open({type:"default",content:[{title:"Media error"},{html:"<p>You can only attach 5 media files per post!</p>"}]},{action:"add",stack:["Media","Error"]});else{for(const[e,n]of Object.entries(t.target.files)){const t=this.tempFilter(n);if(!t.valid)return void this.modalService.open({type:"default",content:[{title:"Media error"},{html:t.message},{html:"<p>Try with images or short videos!</p>"}]},{action:"add",stack:["Media","Error"]});this.selectedMedia.push(n),this.createFormData(n,e=>{this.selectedMediaBlob.push({format:t.format,url:e})})}this.selectedMediaIndex=this.selectedMedia.length-1}}onCancelSelectedMedia(t){this.selectedMedia.splice(t,1),this.selectedMediaBlob.splice(t,1),this.selectedMediaIndex>this.selectedMedia.length-1&&0!==this.selectedMedia.length&&(this.selectedMediaIndex-=1)}createFormData(t,e){const n=new FileReader;n.readAsDataURL(t),n.onload=t=>{this.mediaSelect.nativeElement.value="",e(n.result)}}tempFilter(t){let e={format:null,valid:null,message:null};const n=t.type.match(/(\w+)\/(\w+)?/);return e.format=n[1],"video"===e.format?(e.valid=!(t.size>15e6),e.message="Max size is 15MB"):"image"===e.format?e.valid=!0:(e.valid=!1,e.message=`'<strong>${n[2]}</strong>' is not a valid format.`),e}getGalleryUrl(){return this.showUploadProgress=!0,this.postsService.uploadGallery(this.selectedMedia).pipe(Object(c.a)(t=>{t.progress?(this.uploadProgress=t.progress,this.modalService.emitResponse(!1,{progress:t.progress})):t.completed&&(this.uploadProgress="Uploaded")}),Object(g.a)(1),Object(u.a)(t=>t))}}return t.\u0275fac=function(e){return new(e||t)(a.Jb(l.a),a.Jb(b.a),a.Jb(p.a))},t.\u0275cmp=a.Db({type:t,selectors:[["app-post-publish"]],viewQuery:function(t,e){var n;1&t&&(a.yc(h,!0),a.yc(m,!0)),2&t&&(a.jc(n=a.Xb())&&(e.postInput=n.first),a.jc(n=a.Xb())&&(e.mediaSelect=n.first))},inputs:{postReply:"postReply",destinationConfig:"destinationConfig"},decls:22,vars:5,consts:[["class","toReply",4,"ngIf"],[1,"a-profile"],[3,"src"],[1,"a-content"],["class","replyRef upper",4,"ngIf"],["contenteditable","true","id","text-box","placeholder","What's happening?"],["postInput",""],[1,"a-buttons"],["type","file","multiple","",2,"display","none",3,"change"],["mediaSelect",""],[1,"bttn-opt"],[1,"icon-box",3,"click"],["width","1em","height","1em","viewBox","0 0 16 16","fill","currentColor","xmlns","http://www.w3.org/2000/svg",1,"bi","bi-image","opt-icon"],["fill-rule","evenodd","d","M14.002 2h-12a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1zm-12-1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12z"],["d","M10.648 7.646a.5.5 0 0 1 .577-.093L15.002 9.5V14h-14v-2l2.646-2.354a.5.5 0 0 1 .63-.062l2.66 1.773 3.71-3.71z"],["fill-rule","evenodd","d","M4.502 7a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"],["style","margin-left:auto",4,"ngIf"],[1,"bttn-post"],[1,"post-bttn","noselect",3,"click"],["class","media",4,"ngIf"],[1,"toReply"],[3,"inputConfig","post"],[1,"replyRef","upper"],[1,"aroba"],[2,"margin-left","auto"],[1,"media"],[1,"count-container"],[4,"ngIf"],[1,"remove-bttn","empty-wrapper",3,"click"],[4,"ngFor","ngForOf"],[1,"media-count",3,"ngClass","click"],[1,"selected-media",3,"src"]],template:function(t,e){if(1&t){const t=a.Pb();a.sc(0,O,2,3,"div",0),a.Ob(1,"article"),a.Ob(2,"div",1),a.Kb(3,"img",2),a.Nb(),a.Ob(4,"div",3),a.sc(5,y,5,1,"div",4),a.Kb(6,"div",5,6),a.Ob(8,"div",7),a.Ob(9,"input",8,9),a.Wb("change",(function(t){return e.onMediaSelect(t)})),a.Nb(),a.Ob(11,"div",10),a.Ob(12,"div",11),a.Wb("click",(function(){return a.nc(t),a.kc(10).click()})),a.Zb(),a.Ob(13,"svg",12),a.Kb(14,"path",13),a.Kb(15,"path",14),a.Kb(16,"path",15),a.Nb(),a.Nb(),a.Nb(),a.sc(17,P,2,1,"div",16),a.Yb(),a.Ob(18,"div",17),a.Ob(19,"div",18),a.Wb("click",(function(){return e.publishPost()})),a.uc(20," Post "),a.Nb(),a.Nb(),a.Nb(),a.sc(21,I,7,4,"div",19),a.Nb(),a.Nb()}2&t&&(a.fc("ngIf",e.postReply),a.zb(3),a.fc("src",e.user.avatar.relativePath,a.pc),a.zb(2),a.fc("ngIf",e.postReply),a.zb(12),a.fc("ngIf",e.showUploadProgress),a.zb(4),a.fc("ngIf",0!==e.selectedMediaBlob.length))},directives:[i.k,f.a,i.j,i.i],styles:["article[_ngcontent-%COMP%]{display:flex;padding:1rem 1rem 0;border-bottom:3px solid var(--primary-color)}.replyRef[_ngcontent-%COMP%]{margin-bottom:.3rem;color:var(--secondary-color);font-size:.8rem}.aroba[_ngcontent-%COMP%]{color:#06b8ff;cursor:pointer}.aroba[_ngcontent-%COMP%]:hover{color:var(--primary-color)}.a-profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:3.4rem;height:3.4rem;border-radius:50%;background-color:var(--hover-color);margin-right:.8rem;padding:.2rem;position:relative}.a-content[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column}.a-buttons[_ngcontent-%COMP%]{margin:.3rem 0}.a-buttons[_ngcontent-%COMP%], .bttn-opt[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.icon-box[_ngcontent-%COMP%]{padding:.5rem;margin-right:.3rem;cursor:pointer;border-radius:500px;outline:0}.icon-box[_ngcontent-%COMP%]:hover{background-color:var(--hover-empty-color)}.opt-icon[_ngcontent-%COMP%]{color:var(--primary-color);width:1.6rem;height:1.6rem}.bttn-post[_ngcontent-%COMP%]{margin-left:auto}.post-bttn[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;padding:.4rem 3rem;border-radius:500px;text-align:center;display:inline;cursor:pointer;background-color:var(--primary-color)}.post-bttn[_ngcontent-%COMP%]:hover{background-color:#15ac59}.save-bttn[_ngcontent-%COMP%]{margin-right:12px;font-size:1.1rem;font-weight:700;padding:.4rem 1rem;border-radius:500px;text-align:center;display:inline;cursor:pointer;background-color:var(--primary-color)}.save-bttn[_ngcontent-%COMP%]:hover{background-color:#15ac59}.toReply[_ngcontent-%COMP%]{margin-bottom:.5rem}#text-box[_ngcontent-%COMP%]{min-height:4rem;font-size:1.5rem;cursor:text;border:none;overflow:auto;outline:none;box-shadow:none}[contenteditable=true][_ngcontent-%COMP%]:empty:before{content:attr(placeholder);pointer-events:none;color:var(--secondary-color);display:block}.selected-media[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:30px;margin-bottom:1rem}.media-count[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;padding:.5rem 1rem;border:0;border-radius:500px;text-align:center;display:inline;cursor:pointer;background-color:var(--primary-color);color:var(--text-color);margin-right:1rem}.media-count[_ngcontent-%COMP%]:hover:not(.current-selected-media){background-color:var(--hover-solid-color)}.count-container[_ngcontent-%COMP%]{margin:1rem 0;display:flex;flex-direction:row;align-items:center}.current-selected-media[_ngcontent-%COMP%]{background-color:var(--hover-empty-color)}.remove-bttn[_ngcontent-%COMP%]{margin-left:auto;padding:.2rem .5rem;font-size:1rem;border-color:orange}"]}),t})();var N=n("OUel");const z=function(){return{destination:1,parentIndex:0}};function S(t,e){1&t&&(a.Ob(0,"div"),a.Kb(1,"app-post-publish",5),a.Nb()),2&t&&(a.zb(1),a.fc("destinationConfig",a.gc(1,z)))}function L(t,e){if(1&t){const t=a.Pb();a.Ob(0,"div",6),a.Ob(1,"span",7),a.uc(2,"In order to post you need to be logged in!"),a.Nb(),a.Ob(3,"div",8),a.Ob(4,"button",9),a.Wb("click",(function(){return a.nc(t),a.ac().auth("Login")})),a.uc(5,"Login"),a.Nb(),a.uc(6," \xa0or\xa0 "),a.Ob(7,"button",9),a.Wb("click",(function(){return a.nc(t),a.ac().auth("Register")})),a.uc(8,"Register"),a.Nb(),a.Nb(),a.Nb()}}function R(t,e){if(1&t&&(a.Mb(0),a.Kb(1,"app-posts-list",10),a.Lb()),2&t){const t=a.ac();a.zb(1),a.fc("queryUrl",t.queryUrl)}}let j=(()=>{class t{constructor(t,e,n,i,o){this.postsService=t,this.locationService=e,this.token=n,this.modalService=i,this.route=o,this.loading=!0}ngOnInit(){const t={explore:{query:"/posts?parent[size]=0&childLevel=0&[limit]=10",auth:!1},home:{query:"/posts/user",auth:!0}};this.token.user$.pipe(Object(s.a)((t,e)=>0!==e&&1!==e?Object(r.a)(t).pipe(Object(c.a)(t=>this.postsService.refreshList())):Object(r.a)(t))).subscribe(t=>{this.isLogged=t}),this.route.params.subscribe(e=>{this.needsLogin=t[e.page].auth,this.queryUrl=t[e.page].query})}auth(t){this.modalService.open({type:"default",content:[{title:"Auth in order to post"},{module:"Auth",component:t,params:{navigateEnd:!1}}]},{action:"add",stack:[t]})}}return t.\u0275fac=function(e){return new(e||t)(a.Jb(l.a),a.Jb(d.a),a.Jb(p.a),a.Jb(b.a),a.Jb(o.a))},t.\u0275cmp=a.Db({type:t,selectors:[["app-posts-page"]],decls:5,vars:3,consts:[[1,"container"],[4,"ngIf","ngIfElse"],["class","border auth-container"],["notLogged",""],[4,"ngIf"],[3,"destinationConfig"],[1,"notLogged"],[1,"auth-text"],[1,"bttn-group"],[1,"bttn","solid-bttn",3,"click"],[3,"queryUrl"]],template:function(t,e){if(1&t&&(a.Ob(0,"div",0),a.sc(1,S,2,2,"div",1),a.sc(2,L,9,0,"ng-template",2,3,a.tc),a.sc(4,R,2,1,"ng-container",4),a.Nb()),2&t){const t=a.kc(3);a.zb(1),a.fc("ngIf",e.isLogged)("ngIfElse",t),a.zb(3),a.fc("ngIf",!e.needsLogin&&null!==e.needsLogin||e.isLogged)}},directives:[i.k,_,N.a],styles:[".notLogged[_ngcontent-%COMP%]{border-bottom:1.5px solid var(--primary-color);display:flex;flex-direction:column;justify-content:center;align-items:center;padding:2rem}.auth-text[_ngcontent-%COMP%]{font-size:1.2rem;padding-bottom:1rem;text-align:center}.bttn-group[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%}.bttn[_ngcontent-%COMP%]{flex:1;max-width:10rem;padding:.8rem 0}"]}),t})();var D=n("5+tZ"),K=n("SxV6");const U=function(t){return{i:t,type:"parent"}},F=function(){return{destination:0}},E=function(){return{owner:!1,thread:!0}};function J(t,e){if(1&t&&(a.Ob(0,"div"),a.Ob(1,"div"),a.Kb(2,"app-post",5),a.Nb(),a.Nb()),2&t){const t=e.$implicit,n=e.index;a.zb(2),a.fc("contextInfo",a.hc(4,U,n))("publishConfig",a.gc(6,F))("inputConfig",a.gc(7,E))("post",t)}}function T(t,e){if(1&t&&(a.Mb(0),a.sc(1,J,3,8,"div",4),a.Lb()),2&t){const t=a.ac();a.zb(1),a.fc("ngForOf",t.mainPost.parent)}}const B=function(){return{empty:!0,owner:!1,thread:!0}},$=function(){return{text:"Loading..."}};function W(t,e){if(1&t&&(a.Ob(0,"div"),a.Ob(1,"div"),a.Kb(2,"app-post",5),a.Nb(),a.Nb()),2&t){const t=e.index;a.zb(2),a.fc("contextInfo",a.hc(4,U,t))("publishConfig",a.gc(6,F))("inputConfig",a.gc(7,B))("post",a.gc(8,$))}}function X(t,e){if(1&t&&(a.Mb(0),a.sc(1,W,3,9,"div",4),a.Lb()),2&t){const t=a.ac();a.zb(1),a.fc("ngForOf",t.mainPost.parent)}}const q=function(){return{destination:1,parentIndex:0}},A=function(){return{owner:!1}};function V(t,e){if(1&t&&(a.Ob(0,"div"),a.Ob(1,"div",6),a.Kb(2,"app-post",7),a.Nb(),a.Nb()),2&t){const t=a.ac();a.zb(2),a.fc("publishConfig",a.gc(3,q))("inputConfig",a.gc(4,A))("post",t.mainPost)}}const Q=function(t){return{i:t,type:"reply"}},G=function(t){return{destination:0,parentIndex:t}},H=function(t,e){return{destination:2,parentIndex:t,childIndex:e}},Z=function(t){return{thread:t}};function Y(t,e){if(1&t&&(a.Ob(0,"div"),a.Ob(1,"div",11),a.Kb(2,"app-post",10),a.Nb(),a.Nb()),2&t){const t=e.$implicit,n=e.index,i=e.last,o=a.ac().index;a.zb(2),a.fc("contextInfo",a.hc(5,Q,o))("publishConfig",a.hc(7,G,o))("deleteConfig",a.ic(9,H,o,n))("inputConfig",a.hc(12,Z,!i))("post",t)}}const tt=function(t){return{i:t,type:"post"}},et=function(t,e){return{destination:2,parentIndex:t,childIndex:e,end:!0}},nt=function(t){return{destination:1,parentIndex:t}};function it(t,e){if(1&t&&(a.Ob(0,"div",9),a.Ob(1,"div"),a.Kb(2,"app-post",10),a.Nb(),a.sc(3,Y,3,14,"div",4),a.Nb()),2&t){const t=e.$implicit,n=e.index;a.zb(2),a.fc("contextInfo",a.hc(6,tt,n))("publishConfig",a.ic(8,et,n,null==t.child?null:t.child.length))("deleteConfig",a.hc(11,nt,n))("inputConfig",a.hc(13,Z,0!==(null==t.child?null:t.child.length)))("post",t),a.zb(1),a.fc("ngForOf",t.child)}}function ot(t,e){1&t&&(a.Ob(0,"h3"),a.uc(1,"No replies yet"),a.Nb())}function st(t,e){if(1&t&&(a.Ob(0,"div"),a.sc(1,it,4,15,"div",8),a.Ob(2,"div",3),a.sc(3,ot,2,0,"h3",2),a.Nb(),a.Nb()),2&t){const t=a.ac(2);a.zb(1),a.fc("ngForOf",t.repliesList),a.zb(2),a.fc("ngIf",!t.repliesList||0===(null==t.repliesList?null:t.repliesList.length))}}function ct(t,e){if(1&t&&(a.Ob(0,"div"),a.sc(1,st,4,2,"div",2),a.Nb()),2&t){const t=a.ac();a.zb(1),a.fc("ngIf",!t.loading)}}function rt(t,e){1&t&&(a.Ob(0,"h3"),a.uc(1,"Searching replies..."),a.Nb())}const at=[{path:"post/:postId",component:(()=>{class t{constructor(t,e,n){this.route=t,this.postsService=e,this.locationService=n,this.loading=!0}ngOnInit(){this.locationService.setStack(["Reply Page"]),this.sub2=this.postsService.posts$.subscribe(t=>{this.repliesList=t}),this.sub$=this.postsService.post$.subscribe(t=>{if(t){this.mainPost=t;const e=this.isPopulated(t.parent),n=this.isPopulated(t.child);e&&n&&this.repliesList||(this.loading=!0,this.postsService.getPostById(t._id).subscribe(t=>{this.mainPost=Object.assign({},this.mainPost,{parent:t.parent,child:t.child}),this.loading=!1}))}else this.loading=!0,this.route.params.pipe(Object(D.a)(t=>this.postsService.getPostById(t.postId)),Object(K.a)()).subscribe(t=>{this.mainPost=Object.assign({},t),this.loading=!1})})}ngOnChanges(t){}ngOnDestroy(){this.sub$.unsubscribe(),this.sub2.unsubscribe(),this.postsService.clearAll()}isPopulated(t){return t&&t.every(t=>"string"!=typeof t)||0===t.length}checkParent(t){return(null==t?void 0:t.parent.length)>0&&"string"!=typeof(null==t?void 0:t.parent[0])}}return t.\u0275fac=function(e){return new(e||t)(a.Jb(o.a),a.Jb(l.a),a.Jb(d.a))},t.\u0275cmp=a.Db({type:t,selectors:[["app-post-article"]],features:[a.xb],decls:8,vars:5,consts:[[1,"container"],[1,"post-list"],[4,"ngIf"],[2,"padding","2rem","text-align","center"],[4,"ngFor","ngForOf"],[3,"contextInfo","publishConfig","inputConfig","post"],[1,"main-post"],[3,"publishConfig","inputConfig","post"],["class","reply-container",4,"ngFor","ngForOf"],[1,"reply-container"],[3,"contextInfo","publishConfig","deleteConfig","inputConfig","post"],[1,"reply"]],template:function(t,e){1&t&&(a.Ob(0,"div",0),a.Ob(1,"div",1),a.sc(2,T,2,1,"ng-container",2),a.sc(3,X,2,1,"ng-container",2),a.sc(4,V,3,5,"div",2),a.sc(5,ct,2,1,"div",2),a.Ob(6,"div",3),a.sc(7,rt,2,0,"h3",2),a.Nb(),a.Nb(),a.Nb()),2&t&&(a.zb(2),a.fc("ngIf",e.checkParent(e.mainPost)),a.zb(1),a.fc("ngIf",e.mainPost&&!e.checkParent(e.mainPost)),a.zb(1),a.fc("ngIf",e.mainPost),a.zb(1),a.fc("ngIf",e.repliesList),a.zb(2),a.fc("ngIf",e.loading))},directives:[i.k,i.j,f.a],styles:[".main-post[_ngcontent-%COMP%]{border-bottom:15px solid var(--primary-color);background:var(--hover-color)}.container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column}.post-list[_ngcontent-%COMP%]{overflow:scroll;flex-grow:1}.post-list[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.reply-container[_ngcontent-%COMP%]{border-bottom:.15rem solid var(--primary-color)}"]}),t})()},{path:":page",component:j},{path:"",redirectTo:"/explore",pathMatch:"full"}];let lt=(()=>{class t{}return t.\u0275mod=a.Hb({type:t}),t.\u0275inj=a.Gb({factory:function(e){return new(e||t)},imports:[[o.e.forChild(at)],o.e]}),t})();var dt=n("ecLf"),pt=n("iTUp");let bt=(()=>{class t{}return t.components={PostComponent:f.a,PostPublishComponent:_,PostsListComponent:N.a},t.\u0275mod=a.Hb({type:t}),t.\u0275inj=a.Gb({factory:function(e){return new(e||t)},imports:[[i.c,lt,dt.a,pt.a]]}),t})()}}]);