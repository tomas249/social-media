function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,o=!1,r=void 0;try{for(var a,c=e[Symbol.iterator]();!(i=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(s){o=!0,r=s}finally{try{i||null==c.return||c.return()}finally{if(o)throw r}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"/6QR":function(e,t,n){"use strict";n.d(t,"a",(function(){return K}));var i,o=n("fXoL"),r=n("NloB"),a=n("Kszi"),c=n("rj1t"),s=n("yHma"),l=n("N3Xk"),d=n("ofXK"),u=["obj"],p=["wrapper"],f=["*"],b=((i=function(){function e(t,n){_classCallCheck(this,e),this.modalService=t,this.renderer=n,this.status=new o.n}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.obj.nativeElement.addEventListener("mouseenter",this.checkDelay.bind(this)),this.wrapper.nativeElement.addEventListener("mouseleave",this.closeTooltip.bind(this))}},{key:"checkDelay",value:function(){var e=this;this.objDim=this.obj.nativeElement.getBoundingClientRect();var t,n={width:(t=this.objDim).width,height:t.height};for(var i in n)this.renderer.setStyle(this.wrapper.nativeElement,i,n[i]+"px");this.renderer.setStyle(this.wrapper.nativeElement,"z-index",3),this.status.emit(!0),clearTimeout(this.time),this.time=setTimeout((function(){return e.openTooltip()}),1500)}},{key:"openTooltip",value:function(){var e=this;this.modalService.closeByType("tooltip"),this.modalService.open({type:"tooltip",content:[{module:"Profile",component:"ProfileCard",params:this.params}],params:{objDimensions:this.objDim},keepOpened:!0},{action:"set",stack:["@"+this.params.user.username]},(function(t){e.status.emit(t)}))}},{key:"closeTooltip",value:function(){this.renderer.setStyle(this.wrapper.nativeElement,"z-index",-1),this.status.emit(!1),clearTimeout(this.time)}},{key:"trigger",set:function(e){null!==e&&(e?this.checkDelay():this.closeTooltip())}}]),e}()).\u0275fac=function(e){return new(e||i)(o.Jb(a.a),o.Jb(o.D))},i.\u0275cmp=o.Db({type:i,selectors:[["tooltip-wrapper"]],contentQueries:function(e,t,n){var i;1&e&&o.Cb(n,u,!0),2&e&&o.jc(i=o.Xb())&&(t.obj=i.first)},viewQuery:function(e,t){var n;1&e&&o.yc(p,!0),2&e&&o.jc(n=o.Xb())&&(t.wrapper=n.first)},inputs:{params:"params",trigger:"trigger"},outputs:{status:"status"},ngContentSelectors:f,decls:3,vars:0,consts:[[1,"wrapper"],["wrapper",""]],template:function(e,t){1&e&&(o.ec(),o.dc(0),o.Kb(1,"div",0,1))},styles:[".wrapper[_ngcontent-%COMP%]{position:absolute;background-color:hsla(0,0%,100%,0);display:block;border-radius:50%;top:0;left:0;cursor:pointer;z-index:-1}"]}),i),g=n("6Kw5"),h=["avatarAnimation"];function v(e,t){1&e&&o.Kb(0,"div",16)}var m=function(e){return{user:e}};function y(e,t){if(1&e){var n=o.Pb();o.Mb(0),o.Ob(1,"tooltip-wrapper",18),o.Wb("status",(function(e){return o.nc(n),o.ac(3).checkTooltipStatus(e)})),o.Ob(2,"img",19,20),o.Wb("click",(function(){o.nc(n);var e=o.ac(3);return e.goToUser(e.post.owner._id)})),o.Nb(),o.Ob(4,"div",21,22),o.Wb("click",(function(){o.nc(n);var e=o.ac(3);return e.goToUser(e.post.owner._id)})),o.Nb(),o.Nb(),o.Lb()}if(2&e){var i=o.ac(3);o.zb(1),o.fc("params",o.hc(3,m,i.post.owner))("trigger",i.triggerTooltip),o.zb(1),o.fc("src",i.post.owner.avatar.relativePath,o.pc)}}function O(e,t){if(1&e&&(o.Mb(0),o.Kb(1,"img",23),o.Lb()),2&e){var n=o.ac(3);o.zb(1),o.fc("src",n.post.owner.avatar.relativePath,o.pc)}}function C(e,t){if(1&e&&(o.Ob(0,"div",17),o.sc(1,y,6,5,"ng-container",7),o.sc(2,O,2,1,"ng-container",7),o.Nb()),2&e){var n=o.ac(2);o.zb(1),o.fc("ngIf",n.config.showOpt),o.zb(1),o.fc("ngIf",!n.config.showOpt)}}function k(e,t){1&e&&(o.Ob(0,"div"),o.Kb(1,"img",24),o.Nb())}function P(e,t){if(1&e){var n=o.Pb();o.Ob(0,"div",25),o.Ob(1,"span",26),o.Wb("click",(function(){return o.nc(n),o.ac(2).onDelete()})),o.uc(2,"clear"),o.Nb(),o.Nb()}}function x(e,t){1&e&&(o.Ob(0,"span"),o.uc(1,"\xa0>\xa0"),o.Nb())}function M(e,t){if(1&e){var n=o.Pb();o.Ob(0,"div",29),o.Ob(1,"span",30),o.Wb("click",(function(){o.nc(n);var e=t.$implicit;return o.ac(3).goToUser(e)})),o.uc(2),o.Nb(),o.sc(3,x,2,0,"span",7),o.Nb()}if(2&e){var i=t.$implicit,r=t.index,a=o.ac(3);o.zb(2),o.vc(i),o.zb(1),o.fc("ngIf",r!==a.post.replyRef.length-1)}}function _(e,t){if(1&e&&(o.Ob(0,"div",27),o.Ob(1,"span"),o.uc(2,"Replying to\xa0"),o.Nb(),o.sc(3,M,4,2,"div",28),o.Nb()),2&e){var n=o.ac(2);o.zb(3),o.fc("ngForOf",n.post.replyRef)}}var w=function(e){return{"current-selected-media":e}};function I(e,t){if(1&e){var n=o.Pb();o.Mb(0),o.Ob(1,"button",34),o.Wb("click",(function(){o.nc(n);var e=t.index;return o.ac(4).post.media[0].selectedIndex=e+1})),o.uc(2),o.Nb(),o.Lb()}if(2&e){var i=t.index,r=o.ac(4);o.zb(1),o.fc("title","Change to image ".concat(i+1))("ngClass",o.hc(3,w,r.post.media[0].selectedIndex===i+1)),o.zb(1),o.vc(i+1)}}function N(e,t){if(1&e&&(o.Ob(0,"div"),o.sc(1,I,3,5,"ng-container",33),o.Nb()),2&e){var n=o.ac(3);o.zb(1),o.fc("ngForOf",n.post.media.slice(1))}}function z(e,t){if(1&e){var n=o.Pb();o.Ob(0,"div"),o.Ob(1,"div",31),o.sc(2,N,2,1,"div",7),o.Nb(),o.Ob(3,"img",32),o.Wb("click",(function(){o.nc(n);var e=o.ac(2);return e.openMedia(e.post.media[e.post.media[0].selectedIndex].fullPath)})),o.Nb(),o.Nb()}if(2&e){var i=o.ac(2);o.zb(2),o.fc("ngIf",i.post.media.length>2),o.zb(1),o.fc("src",i.post.media[i.post.media[0].selectedIndex].relativePath,o.pc)}}function S(e,t){if(1&e&&(o.Ob(0,"span"),o.uc(1),o.Nb()),2&e){var n=o.ac(4);o.zb(1),o.wc("\xa0(",n.replyingProgress,")")}}function L(e,t){if(1&e&&(o.Ob(0,"span",47),o.uc(1," ~ publishing "),o.sc(2,S,2,1,"span",7),o.Nb()),2&e){var n=o.ac(3);o.zb(2),o.fc("ngIf",0!==n.replyingProgress)}}function R(e,t){1&e&&(o.Ob(0,"span",48),o.uc(1,"\xa0~ published"),o.Nb())}function j(e,t){if(1&e){var n=o.Pb();o.Ob(0,"span",49),o.Wb("click",(function(){return o.nc(n),o.ac(3).onLike()})),o.uc(1,"favorite_border"),o.Nb()}}function T(e,t){if(1&e){var n=o.Pb();o.Ob(0,"span",50),o.Wb("click",(function(){return o.nc(n),o.ac(3).onLike()})),o.uc(1,"favorite"),o.Nb()}}function U(e,t){if(1&e){var n=o.Pb();o.Ob(0,"div",35),o.Ob(1,"div",36),o.Ob(2,"div",37),o.Ob(3,"span",38),o.Wb("click",(function(){return o.nc(n),o.ac(2).onReply()})),o.uc(4,"chat_bubble_outline"),o.Nb(),o.Nb(),o.Ob(5,"span",39),o.uc(6),o.sc(7,L,3,1,"span",40),o.sc(8,R,2,0,"span",41),o.Nb(),o.Nb(),o.Ob(9,"div",42),o.Ob(10,"div",37),o.sc(11,j,2,0,"span",43),o.sc(12,T,2,0,"span",44),o.Nb(),o.Ob(13,"span",39),o.uc(14),o.Nb(),o.Nb(),o.Ob(15,"div",36),o.Ob(16,"div",45),o.Ob(17,"span",46),o.Wb("click",(function(){return o.nc(n),o.ac(2).onShare()})),o.uc(18,"send"),o.Nb(),o.Nb(),o.Nb(),o.Nb()}if(2&e){var i=o.ac(2);o.zb(6),o.wc(" ",i.count.replies," "),o.zb(1),o.fc("ngIf",i.config.publishing),o.zb(1),o.fc("ngIf",i.config.replied),o.zb(3),o.fc("ngIf",!i.config.liked),o.zb(1),o.fc("ngIf",i.config.liked),o.zb(2),o.wc(" ",i.count.likes," ")}}var A=function(){return{filter:"blur(1.5px)"}};function D(e,t){if(1&e){var n=o.Pb();o.Ob(0,"article",1),o.Ob(1,"div",2),o.Wb("click",(function(){return o.nc(n),o.ac().openReplyPage()})),o.Nb(),o.Ob(2,"div",3),o.Ob(3,"div",4),o.sc(4,v,1,0,"div",5),o.sc(5,C,3,2,"div",6),o.sc(6,k,2,0,"div",7),o.Nb(),o.Ob(7,"div",8),o.Ob(8,"div",9),o.Ob(9,"span",10),o.Ob(10,"span"),o.Ob(11,"div"),o.Ob(12,"span",11),o.Wb("mouseenter",(function(){return o.nc(n),o.ac().onOpenUser()}))("mouseleave",(function(){return o.nc(n),o.ac().onCloseUser()}))("click",(function(){o.nc(n);var e=o.ac();return e.goToUser(e.post.owner._id)})),o.uc(13),o.Nb(),o.Ob(14,"span"),o.uc(15),o.bc(16,"dateAgo"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.sc(17,P,3,0,"div",12),o.Nb(),o.sc(18,_,4,1,"div",13),o.Ob(19,"div",14),o.uc(20),o.Nb(),o.sc(21,z,4,2,"div",7),o.sc(22,U,19,6,"div",15),o.Nb(),o.Nb(),o.Nb()}if(2&e){var i=o.ac();o.fc("ngClass",i.config.openPage&&"select-hover")("ngStyle",i.config.loading&&o.gc(14,A)),o.zb(4),o.fc("ngIf",i.config.thread),o.zb(1),o.fc("ngIf",i.post.owner),o.zb(1),o.fc("ngIf",i.config.empty),o.zb(7),o.wc(" @",i.post.owner.username," "),o.zb(2),o.wc(" - ",o.cc(16,12,i.post.createdAt),""),o.zb(2),o.fc("ngIf",i.config.owner&&i.config.showOpt&&!i.config.loading),o.zb(1),o.fc("ngIf",i.post.replyRef&&0!==i.post.replyRef.length),o.zb(2),o.wc(" ",i.post.text," "),o.zb(1),o.fc("ngIf",i.post.media&&0!==i.post.media.length),o.zb(1),o.fc("ngIf",i.config.showOpt)}}var F,K=((F=function(){function e(t,n,i,o,r,a){_classCallCheck(this,e),this.postsService=t,this.modalService=n,this.token=i,this.locationService=o,this.navbarService=r,this.renderer=a,this.contextInfo={i:0,type:void 0},this.config={showOpt:!0,openPage:!0,owner:!1,replied:!1,publishing:!1,deleted:!1,liked:!1,shared:!1,reported:!1,thread:!1,tooltip:!0,loading:!1,empty:!1},this.count={replies:0,likes:0,shares:0},this.mediaSelIdx=0,this.replyingProgress=0,this.triggerTooltip=null,this.tooltipOpened=!1}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(e){var t,n,i,o,r=(null===(n=null===(t=e.post)||void 0===t?void 0:t.previousValue)||void 0===n?void 0:n._id)!==(null===(i=e.post)||void 0===i?void 0:i.currentValue._id);!(null===(o=e.post)||void 0===o?void 0:o.firstChange)&&r&&(this.config=Object.assign(this.config,this._inputConfig),this._post.media&&0!==this._post.media.length&&!this._post.media.selectedIndex&&this._post.media.unshift({selectedIndex:1}),this.config.replied=!1,this.config.deleted=!1)}},{key:"countData",value:function(e){var t;this.count={replies:(null===(t=e.child)||void 0===t?void 0:t.length)||0,likes:e.likes,shares:0}}},{key:"auth",value:function(e,t){return this.config.owner=e.owner._id===t&&(!this.inputConfig.hasOwnProperty("owner")||this.inputConfig.owner),this.config.liked=e.whoLiked.includes(t),t&&(e.confirm={owner:this.config.owner,liked:this.config.liked}),e}},{key:"goToUser",value:function(e){this.config.showOpt&&this.navbarService.go("/u/"+e)}},{key:"onReply",value:function(){var e=this;this.checkAuth("In order to reply a post you need to be logged in")&&this.modalService.open({type:"default",content:[{module:"Posts",component:"PostPublish",params:{postReply:this.post,destinationConfig:this.publishConfig}}]},{action:"add",stack:["Reply"]},(function(t){var n;t?t&&t.hasOwnProperty("progress")?e.replyingProgress=t.progress:(e.count.replies+=1,e.config.publishing=!1,e.config.replied=!0,e.replyingProgress=0,["list","reply"].includes(null===(n=e.contextInfo)||void 0===n?void 0:n.type)&&e.post.child.push(t)):(e.config.replied=!1,e.config.publishing=!0,e.locationService.removeItemFromStack(2),e.locationService.addItemToStack(["Publishing reply..."]))}))}},{key:"onLike",value:function(){this.checkAuth("In order to like a post you need to be logged in")&&(this.config.liked?(this.config.liked=!1,this.count.likes-=1):(this.config.liked=!0,this.count.likes+=1),this.postsService.likePost(this.post._id))}},{key:"onDelete",value:function(){this.postsService.deletePost(this.post._id,this.deleteConfig)}},{key:"openReplyPage",value:function(){this.config.openPage&&(this.modalService.forceClose(),this.postsService.setMainPost(Object.assign({},this.post),this.contextInfo),this.navbarService.go("/post/"+this.post._id))}},{key:"onShare",value:function(){var e="".concat(window.location.host,"/p/").concat(this.post._id);this.modalService.open({type:"default",content:[{title:"Share a post"},{html:'<p align="center">'.concat(e,"</p>")}]},{action:"add",stack:["Share"]})}},{key:"onOpenUser",value:function(){!this.tooltipOpened&&this.config.showOpt&&(this.triggerTooltip=!0)}},{key:"onCloseUser",value:function(){this.triggerTooltip=!1}},{key:"checkTooltipStatus",value:function(e){this.tooltipOpened=e,e?this.avatarAnimation.nativeElement.className="loading-avatar":this.renderer.removeClass(this.avatarAnimation.nativeElement,"loading-avatar")}},{key:"checkAuth",value:function(e){return!!this.token.isLogged()||(this.modalService.open({type:"default",content:[{title:e},{module:"Auth",component:"Login",params:{navigateEnd:!1}}]},{action:"add",stack:["Login"]}),!1)}},{key:"openMedia",value:function(e){this.modalService.open({type:"extended",content:[{title:"Media from @"+this.post.owner.username},{html:'<img width="100%" src="'.concat(e,'">')}]},{action:"add",stack:["Media"]})}},{key:"inputConfig",set:function(e){this.config=Object.assign(this.config,e),this._inputConfig=e},get:function(){return this._inputConfig||{}}},{key:"post",set:function(e){if(e.media&&0!==e.media.length&&!e.media[0].selectedIndex&&e.media.unshift({selectedIndex:1}),this.config.empty)e._id="loading...",e.replyRef=Array(this.contextInfo.i).fill("???"),this._post=e;else if(e._id)this.countData(e),this._post=this.auth(e,this.token.getUserId()),this._post=Object.assign({},e);else{var t=this.token.getUserData();e.owner={_id:(n=t).id,name:n.name,username:n.username,avatar:n.avatar},this.config.owner=!0,this.config.loading=!0,this.config.thread=!1,this._post=e}var n},get:function(){return this._post}}]),e}()).\u0275fac=function(e){return new(e||F)(o.Jb(r.a),o.Jb(a.a),o.Jb(c.a),o.Jb(s.a),o.Jb(l.a),o.Jb(o.D))},F.\u0275cmp=o.Db({type:F,selectors:[["app-post"]],viewQuery:function(e,t){var n;1&e&&o.yc(h,!0),2&e&&o.jc(n=o.Xb())&&(t.avatarAnimation=n.first)},inputs:{contextInfo:"contextInfo",publishConfig:"publishConfig",deleteConfig:"deleteConfig",inputConfig:"inputConfig",post:"post"},features:[o.xb],decls:1,vars:1,consts:[[3,"ngClass","ngStyle",4,"ngIf"],[3,"ngClass","ngStyle"],[1,"route",3,"click"],[1,"post"],[1,"a-profile"],["class","thread-line",4,"ngIf"],["class","a-profile-avatar",4,"ngIf"],[4,"ngIf"],[1,"a-content"],[1,"a-acc"],[1,"a-username"],[1,"aroba",3,"mouseenter","mouseleave","click"],["class","delete-bttn","style","margin-left: auto",4,"ngIf"],["class","replyRef",4,"ngIf"],[1,"a-text"],["class","a-buttons noselect",4,"ngIf"],[1,"thread-line"],[1,"a-profile-avatar"],[3,"params","trigger","status"],[1,"a-avatar",3,"src","click"],["obj",""],[3,"click"],["avatarAnimation",""],[1,"a-avatar",3,"src"],[1,"a-avatar",2,"background-color","lightgray"],[1,"delete-bttn",2,"margin-left","auto"],["title","Delete post",1,"material-icons",3,"click"],[1,"replyRef"],["class","arobas",4,"ngFor","ngForOf"],[1,"arobas"],[1,"aroba",3,"click"],[1,"count-container"],["title","Click to open full screen",1,"selected-media",3,"src","click"],[4,"ngFor","ngForOf"],[1,"media-count",3,"title","ngClass","click"],[1,"a-buttons","noselect"],[1,"a-bttn-group"],[1,"a-bttn-icon-box"],["title","Reply",1,"material-icons","a-bttn-icon",3,"click"],[1,"a-bttn-count"],["class","notify","style","color: orange",4,"ngIf"],["class","primary notify",4,"ngIf"],[1,"a-bttn-group","noselect"],["title","Like","class","material-icons a-bttn-icon",3,"click",4,"ngIf"],["title","Dislike","class","material-icons a-bttn-icon red",3,"click",4,"ngIf"],[1,"a-bttn-icon-box","a-bttn-icon"],["title","Share",1,"material-icons","a-bttn-icon",3,"click"],[1,"notify",2,"color","orange"],[1,"primary","notify"],["title","Like",1,"material-icons","a-bttn-icon",3,"click"],["title","Dislike",1,"material-icons","a-bttn-icon","red",3,"click"]],template:function(e,t){1&e&&o.sc(0,D,23,15,"article",0),2&e&&o.fc("ngIf",t.post)},directives:[d.k,d.i,d.l,b,d.j],pipes:[g.a],styles:["article[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:relative;padding-bottom:.5rem}.select-hover[_ngcontent-%COMP%]:hover{background-color:#111d29}.route[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;cursor:pointer}.bar-container[_ngcontent-%COMP%]{margin:10px auto;width:80%;text-align:center}.progress[_ngcontent-%COMP%]{padding:3px;border-radius:12px;background:rgba(0,0,0,.25)}.progress-bar[_ngcontent-%COMP%]{height:.2rem;border-radius:30px;width:85%;background-color:rgba(71,239,99,.47)}.material-icons[_ngcontent-%COMP%]{cursor:pointer;position:relative}.replyRef[_ngcontent-%COMP%]{margin-bottom:.3rem;color:var(--secondary-color);font-size:.8rem}.notify[_ngcontent-%COMP%]{position:absolute}.arobas[_ngcontent-%COMP%]{display:inline-block}.aroba[_ngcontent-%COMP%]{color:#06b8ff;cursor:pointer;position:relative;z-index:1}.aroba[_ngcontent-%COMP%]:hover{color:var(--primary-color)}.post[_ngcontent-%COMP%]{padding:1rem 1rem 0}.a-acc[_ngcontent-%COMP%], .post[_ngcontent-%COMP%]{display:flex}.a-name[_ngcontent-%COMP%]{color:var(--text-color);font-weight:700;margin-right:.3rem}.a-name[_ngcontent-%COMP%], .a-username[_ngcontent-%COMP%]{font-size:1rem;cursor:pointer}.a-username[_ngcontent-%COMP%]{color:#8899a6}.a-profile[_ngcontent-%COMP%]{display:flex;flex-direction:column}.a-avatar[_ngcontent-%COMP%], .a-profile-avatar[_ngcontent-%COMP%]{position:relative}.a-avatar[_ngcontent-%COMP%]{width:3.4rem;height:3.4rem;border-radius:50%;background-color:var(--hover-color);padding:.2rem;cursor:pointer;z-index:1}.a-content[_ngcontent-%COMP%]{margin-left:.8rem;flex:1;display:flex;flex-direction:column}.a-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin:.3rem 0;flex:1}.a-bttn-group[_ngcontent-%COMP%]{width:100%;flex-direction:row;margin-right:auto;cursor:pointer}.a-bttn-group[_ngcontent-%COMP%], .a-bttn-icon-box[_ngcontent-%COMP%]{display:flex;align-items:center}.a-bttn-icon-box[_ngcontent-%COMP%]{padding:.7rem;border-radius:50%}.a-bttn-count[_ngcontent-%COMP%], .a-bttn-icon[_ngcontent-%COMP%]{color:var(--secondary-color);z-index:1}.a-bttn-icon-box[_ngcontent-%COMP%]:hover{background-color:var(--hover-empty-color)}.a-bttn-icon-box[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%], .a-bttn-icon-box[_ngcontent-%COMP%]:hover ~ .a-bttn-count[_ngcontent-%COMP%]{color:var(--primary-color)}.a-text[_ngcontent-%COMP%]{position:relative}.comment[_ngcontent-%COMP%]{padding:1rem 1rem 0}.thread-line[_ngcontent-%COMP%]{border-left:3px solid #8899a6;margin-left:30px;height:100%;margin-top:2rem;position:absolute}.red[_ngcontent-%COMP%]{color:#ff6a6a;border:0}.selected-media[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:30px;position:relative;cursor:pointer;transition:transform .2s}.selected-media[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.media-count[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;padding:.5rem 1rem;border:0;border-radius:500px;text-align:center;display:inline;cursor:pointer;background-color:var(--primary-color);color:var(--text-color);margin-right:1rem;position:relative}.media-count[_ngcontent-%COMP%]:hover:not(.current-selected-media){background-color:var(--hover-solid-color)}.count-container[_ngcontent-%COMP%]{margin:1rem 0;display:flex;flex-direction:row;align-items:center}.current-selected-media[_ngcontent-%COMP%]{background-color:var(--hover-empty-color)}.delete-bttn[_ngcontent-%COMP%]{margin-left:auto;cursor:pointer}.loading-avatar[_ngcontent-%COMP%]{position:absolute;z-index:2;width:3.8rem;height:3.8rem;top:0;border-radius:50%;background-color:rgba(23,191,99,.589);-webkit-animation:example 1.5s linear .1s;animation:example 1.5s linear .1s;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}@-webkit-keyframes example{0%{width:3.8rem;height:3.8rem;left:0;top:0}to{width:0;height:0;left:1.9rem;top:1.9rem}}@keyframes example{0%{width:3.8rem;height:3.8rem;left:0;top:0}to{width:0;height:0;left:1.9rem;top:1.9rem}}"]}),F)},"6Kw5":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("fXoL"),o=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"transform",value:function(e,t){if(e){var n=Math.floor((+new Date-+new Date(e))/1e3);if(n<29)return"Just now";var i,o={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};for(var r in o)if((i=Math.floor(n/o[r]))>0)return 1===i?i+" "+r+" ago":i+" "+r+"s ago"}return e}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=i.Ib({name:"dateAgo",type:e,pure:!0}),e}()},OUel:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n("SxV6"),o=n("fXoL"),r=n("NloB"),a=n("ofXK"),c=n("/6QR");function s(e,t){1&e&&(o.Ob(0,"div",3),o.Ob(1,"h3"),o.uc(2,"Searching posts..."),o.Nb(),o.Nb())}var l=function(e){return{showOpt:e,openPage:!0}},d=function(e){return{i:e,type:"list"}},u=function(){return{destination:0}},p=function(e){return{destination:1,parentIndex:e}};function f(e,t){if(1&e&&(o.Ob(0,"div",7),o.Kb(1,"app-post",8),o.Nb()),2&e){var n=t.$implicit,i=t.index,r=o.ac(3);o.zb(1),o.fc("inputConfig",o.hc(5,l,r.showOptPosts))("contextInfo",o.hc(7,d,i))("publishConfig",o.gc(9,u))("deleteConfig",o.hc(10,p,i))("post",n)}}function b(e,t){if(1&e&&(o.Ob(0,"div"),o.sc(1,f,2,12,"div",6),o.Nb()),2&e){var n=o.ac().ngIf;o.zb(1),o.fc("ngForOf",n)}}function g(e,t){1&e&&(o.Ob(0,"div",3),o.Ob(1,"h3"),o.uc(2,"No posts published yet"),o.Nb(),o.Nb())}function h(e,t){if(1&e&&(o.Ob(0,"div",4),o.sc(1,b,2,1,"div",5),o.sc(2,g,3,0,"div",1),o.Nb()),2&e){var n=t.ngIf,i=o.ac();o.zb(1),o.fc("ngIf",!i.loading&&n&&0!==n.length),o.zb(1),o.fc("ngIf",!i.loading&&0===n.length)}}var v=function(){var e=function(){function e(t){_classCallCheck(this,e),this.postsService=t,this.showOptPosts=!0,this.loading=!0}return _createClass(e,[{key:"ngOnInit",value:function(){this.postsList$=this.postsService.posts$}},{key:"queryUrl",set:function(e){var t=this;this.loading=!0,this.postsService.getPostsList(e).pipe(Object(i.a)()).subscribe((function(e){t.loading=!1,t.pageInfo={count:e.count,pagination:e.pagination}})),this._queryUrl=e},get:function(){return this._queryUrl}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.Jb(r.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-posts-list"]],inputs:{showOptPosts:"showOptPosts",queryUrl:"queryUrl"},decls:4,vars:4,consts:[[1,"container"],["style","padding: 2rem; text-align: center;",4,"ngIf"],["class","posts-list",4,"ngIf"],[2,"padding","2rem","text-align","center"],[1,"posts-list"],[4,"ngIf"],["class","border",4,"ngFor","ngForOf"],[1,"border"],[3,"inputConfig","contextInfo","publishConfig","deleteConfig","post"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.sc(1,s,3,0,"div",1),o.sc(2,h,3,2,"div",2),o.bc(3,"async"),o.Nb()),2&e&&(o.zb(1),o.fc("ngIf",t.loading),o.zb(1),o.fc("ngIf",o.cc(3,2,t.postsList$)))},directives:[a.k,a.j,c.a],pipes:[a.b],styles:[".container[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column}.border[_ngcontent-%COMP%]{border-bottom:1.5px solid var(--primary-color)}.auth-container[_ngcontent-%COMP%]{padding:1rem;justify-content:center}.auth-container[_ngcontent-%COMP%], .notLogged[_ngcontent-%COMP%]{display:flex;align-items:center}.notLogged[_ngcontent-%COMP%]{flex-direction:column;margin:0 auto}.bttn[_ngcontent-%COMP%]{border:0;font-size:1.1rem;font-weight:700;padding:.6rem 3rem;border-radius:500px;text-align:center;display:inline;cursor:pointer;background-color:var(--primary-color)}.bttn[_ngcontent-%COMP%]:hover{background-color:#15ac59}.auth-text[_ngcontent-%COMP%]{font-size:1.3rem;padding-bottom:.5rem}"]}),e}()},iTUp:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("fXoL"),o=function(){var e=function e(){_classCallCheck(this,e)};return e.\u0275mod=i.Hb({type:e}),e.\u0275inj=i.Gb({factory:function(t){return new(t||e)}}),e}()},xZLo:function(e,t,n){"use strict";n.r(t),n.d(t,"PostsModule",(function(){return ge}));var i=n("ofXK"),o=n("tyNb"),r=n("lJxs"),a=n("fXoL"),c=n("NloB"),s=n("yHma"),l=n("rj1t"),d=n("Kszi"),u=n("vkgz"),p=n("BFxc"),f=n("/6QR"),b=["postInput"],g=["mediaSelect"],h=function(){return{showOpt:!1,thread:!0,openPage:!1}};function v(e,t){if(1&e&&(a.Ob(0,"div",20),a.Kb(1,"app-post",21),a.Nb()),2&e){var n=a.ac();a.zb(1),a.fc("inputConfig",a.gc(2,h))("post",n.postReply)}}function m(e,t){if(1&e&&(a.Ob(0,"div",22),a.Ob(1,"span"),a.uc(2,"Replying to\xa0"),a.Nb(),a.Ob(3,"span",23),a.uc(4),a.Nb(),a.Nb()),2&e){var n=a.ac();a.zb(4),a.wc("@",n.postReply.owner.username,"")}}function y(e,t){if(1&e&&(a.Zb(),a.Yb(),a.Ob(0,"div",24),a.uc(1),a.Nb()),2&e){var n=a.ac();a.zb(1),a.wc(" Uploading ",n.uploadProgress,"% ")}}var O=function(e){return{"current-selected-media":e}};function C(e,t){if(1&e){var n=a.Pb();a.Mb(0),a.Ob(1,"button",30),a.Wb("click",(function(){a.nc(n);var e=t.index;return a.ac(3).selectedMediaIndex=e})),a.uc(2),a.Nb(),a.Lb()}if(2&e){var i=t.index,o=a.ac(3);a.zb(1),a.fc("ngClass",a.hc(2,O,o.selectedMediaIndex===i)),a.zb(1),a.vc(i+1)}}function k(e,t){if(1&e&&(a.Ob(0,"div"),a.sc(1,C,3,4,"ng-container",29),a.Nb()),2&e){var n=a.ac(2);a.zb(1),a.fc("ngForOf",n.selectedMediaBlob)}}function P(e,t){if(1&e&&(a.Ob(0,"div"),a.Kb(1,"img",31),a.Nb()),2&e){var n=a.ac(2);a.zb(1),a.fc("src",n.selectedMediaBlob[n.selectedMediaIndex].url,a.pc)}}function x(e,t){if(1&e&&(a.Ob(0,"div"),a.Ob(1,"span"),a.Ob(2,"i"),a.uc(3,"Video thumbnail"),a.Nb(),a.Nb(),a.Kb(4,"video",31),a.Nb()),2&e){var n=a.ac(2);a.zb(4),a.fc("src",n.selectedMediaBlob[n.selectedMediaIndex].url,a.pc)}}function M(e,t){if(1&e){var n=a.Pb();a.Ob(0,"div",25),a.Ob(1,"div",26),a.sc(2,k,2,1,"div",27),a.Ob(3,"div",28),a.Wb("click",(function(){a.nc(n);var e=a.ac();return e.onCancelSelectedMedia(e.selectedMediaIndex)})),a.uc(4),a.Nb(),a.Nb(),a.sc(5,P,2,1,"div",27),a.sc(6,x,5,1,"div",27),a.Nb()}if(2&e){var i=a.ac();a.zb(2),a.fc("ngIf",i.selectedMediaBlob.length>1),a.zb(2),a.wc("Remove media ",i.selectedMediaIndex+1,""),a.zb(1),a.fc("ngIf","image"===(null==i.selectedMediaBlob[i.selectedMediaIndex]?null:i.selectedMediaBlob[i.selectedMediaIndex].format)),a.zb(1),a.fc("ngIf","video"===(null==i.selectedMediaBlob[i.selectedMediaIndex]?null:i.selectedMediaBlob[i.selectedMediaIndex].format))}}var _,w=((_=function(){function e(t,n,i){_classCallCheck(this,e),this.postsService=t,this.modalService=n,this.token=i,this.postReply=null,this.destinationConfig=null,this.selectedMedia=[],this.selectedMediaBlob=[],this.selectedMediaIndex=-1,this.showUploadProgress=!1,this.uploadProgress=0}return _createClass(e,[{key:"ngOnInit",value:function(){this.user=this.token.getUserData()}},{key:"publishPost",value:function(){var e=this,t=this.postInput.nativeElement.innerText;if(t){this.modalService.emitResponse(!1,!1);var n={text:t,media:0!==this.selectedMedia.length?this.selectedMedia:null};this.publisher$=(e.postReply?e.postsService.replyPost(e.postReply._id,n,e.destinationConfig):e.postsService.publishPost(n,e.destinationConfig)).subscribe((function(t){t.progress?(e.showUploadProgress=!0,e.uploadProgress=t.progress):e.showUploadProgress=!1,e.modalService.emitResponse(!t.hasOwnProperty("progress"),t)})),this.clear()}}},{key:"clear",value:function(){this.postInput.nativeElement.innerText="",this.mediaSelect.nativeElement.value="",this.selectedMedia=[],this.selectedMediaBlob=[],this.selectedMediaIndex=0}},{key:"onMediaSelect",value:function(e){var t=this;if(this.selectedMedia.length+e.target.files.length>5)this.modalService.open({type:"default",content:[{title:"Media error"},{html:"<p>You can only attach 5 media files per post!</p>"}]},{action:"add",stack:["Media","Error"]});else{for(var n=function(){var e=_slicedToArray(o[i],2),n=(e[0],e[1]),r=t.tempFilter(n);if(!r.valid)return{v:void t.modalService.open({type:"default",content:[{title:"Media error"},{html:r.message},{html:"<p>Try with images or short videos!</p>"}]},{action:"add",stack:["Media","Error"]})};t.selectedMedia.push(n),t.createFormData(n,(function(e){t.selectedMediaBlob.push({format:r.format,url:e})}))},i=0,o=Object.entries(e.target.files);i<o.length;i++){var r=n();if("object"==typeof r)return r.v}this.selectedMediaIndex=this.selectedMedia.length-1}}},{key:"onCancelSelectedMedia",value:function(e){this.selectedMedia.splice(e,1),this.selectedMediaBlob.splice(e,1),this.selectedMediaIndex>this.selectedMedia.length-1&&0!==this.selectedMedia.length&&(this.selectedMediaIndex-=1)}},{key:"createFormData",value:function(e,t){var n=this,i=new FileReader;i.readAsDataURL(e),i.onload=function(e){n.mediaSelect.nativeElement.value="",t(i.result)}}},{key:"tempFilter",value:function(e){var t={format:null,valid:null,message:null},n=e.type.match(/(\w+)\/(\w+)?/);return t.format=n[1],"video"===t.format?(t.valid=!(e.size>15e6),t.message="Max size is 15MB"):"image"===t.format?t.valid=!0:(t.valid=!1,t.message="'<strong>".concat(n[2],"</strong>' is not a valid format.")),t}},{key:"getGalleryUrl",value:function(){var e=this;return this.showUploadProgress=!0,this.postsService.uploadGallery(this.selectedMedia).pipe(Object(u.a)((function(t){t.progress?(e.uploadProgress=t.progress,e.modalService.emitResponse(!1,{progress:t.progress}),console.log(e.uploadProgress)):t.completed&&(e.uploadProgress="Uploaded")})),Object(p.a)(1),Object(r.a)((function(e){return e})))}},{key:"test",value:function(){console.log(this.selectedMedia)}}]),e}()).\u0275fac=function(e){return new(e||_)(a.Jb(c.a),a.Jb(d.a),a.Jb(l.a))},_.\u0275cmp=a.Db({type:_,selectors:[["app-post-publish"]],viewQuery:function(e,t){var n;1&e&&(a.yc(b,!0),a.yc(g,!0)),2&e&&(a.jc(n=a.Xb())&&(t.postInput=n.first),a.jc(n=a.Xb())&&(t.mediaSelect=n.first))},inputs:{postReply:"postReply",destinationConfig:"destinationConfig"},decls:22,vars:5,consts:[["class","toReply",4,"ngIf"],[1,"a-profile"],[3,"src"],[1,"a-content"],["class","replyRef upper",4,"ngIf"],["contenteditable","true","id","text-box","placeholder","What's happening?"],["postInput",""],[1,"a-buttons"],["type","file","multiple","",2,"display","none",3,"change"],["mediaSelect",""],[1,"bttn-opt"],[1,"icon-box",3,"click"],["width","1em","height","1em","viewBox","0 0 16 16","fill","currentColor","xmlns","http://www.w3.org/2000/svg",1,"bi","bi-image","opt-icon"],["fill-rule","evenodd","d","M14.002 2h-12a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1zm-12-1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12z"],["d","M10.648 7.646a.5.5 0 0 1 .577-.093L15.002 9.5V14h-14v-2l2.646-2.354a.5.5 0 0 1 .63-.062l2.66 1.773 3.71-3.71z"],["fill-rule","evenodd","d","M4.502 7a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"],["style","margin-left:auto",4,"ngIf"],[1,"bttn-post"],[1,"post-bttn","noselect",3,"click"],["class","media",4,"ngIf"],[1,"toReply"],[3,"inputConfig","post"],[1,"replyRef","upper"],[1,"aroba"],[2,"margin-left","auto"],[1,"media"],[1,"count-container"],[4,"ngIf"],[1,"remove-bttn","empty-wrapper",3,"click"],[4,"ngFor","ngForOf"],[1,"media-count",3,"ngClass","click"],[1,"selected-media",3,"src"]],template:function(e,t){if(1&e){var n=a.Pb();a.sc(0,v,2,3,"div",0),a.Ob(1,"article"),a.Ob(2,"div",1),a.Kb(3,"img",2),a.Nb(),a.Ob(4,"div",3),a.sc(5,m,5,1,"div",4),a.Kb(6,"div",5,6),a.Ob(8,"div",7),a.Ob(9,"input",8,9),a.Wb("change",(function(e){return t.onMediaSelect(e)})),a.Nb(),a.Ob(11,"div",10),a.Ob(12,"div",11),a.Wb("click",(function(){return a.nc(n),a.kc(10).click()})),a.Zb(),a.Ob(13,"svg",12),a.Kb(14,"path",13),a.Kb(15,"path",14),a.Kb(16,"path",15),a.Nb(),a.Nb(),a.Nb(),a.sc(17,y,2,1,"div",16),a.Yb(),a.Ob(18,"div",17),a.Ob(19,"div",18),a.Wb("click",(function(){return t.publishPost()})),a.uc(20," Post "),a.Nb(),a.Nb(),a.Nb(),a.sc(21,M,7,4,"div",19),a.Nb(),a.Nb()}2&e&&(a.fc("ngIf",t.postReply),a.zb(3),a.fc("src",t.user.avatar.relativePath,a.pc),a.zb(2),a.fc("ngIf",t.postReply),a.zb(12),a.fc("ngIf",t.showUploadProgress),a.zb(4),a.fc("ngIf",0!==t.selectedMediaBlob.length))},directives:[i.k,f.a,i.j,i.i],styles:["article[_ngcontent-%COMP%]{display:flex;padding:1rem 1rem 0;border-bottom:3px solid var(--primary-color)}.replyRef[_ngcontent-%COMP%]{margin-bottom:.3rem;color:var(--secondary-color);font-size:.8rem}.aroba[_ngcontent-%COMP%]{color:#06b8ff;cursor:pointer}.aroba[_ngcontent-%COMP%]:hover{color:var(--primary-color)}.a-profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:3.4rem;height:3.4rem;border-radius:50%;background-color:var(--hover-color);margin-right:.8rem;padding:.2rem;position:relative}.a-content[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column}.a-buttons[_ngcontent-%COMP%]{margin:.3rem 0}.a-buttons[_ngcontent-%COMP%], .bttn-opt[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.icon-box[_ngcontent-%COMP%]{padding:.5rem;margin-right:.3rem;cursor:pointer;border-radius:500px;outline:0}.icon-box[_ngcontent-%COMP%]:hover{background-color:var(--hover-empty-color)}.opt-icon[_ngcontent-%COMP%]{color:var(--primary-color);width:1.6rem;height:1.6rem}.bttn-post[_ngcontent-%COMP%]{margin-left:auto}.post-bttn[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;padding:.4rem 3rem;border-radius:500px;text-align:center;display:inline;cursor:pointer;background-color:var(--primary-color)}.post-bttn[_ngcontent-%COMP%]:hover{background-color:#15ac59}.save-bttn[_ngcontent-%COMP%]{margin-right:12px;font-size:1.1rem;font-weight:700;padding:.4rem 1rem;border-radius:500px;text-align:center;display:inline;cursor:pointer;background-color:var(--primary-color)}.save-bttn[_ngcontent-%COMP%]:hover{background-color:#15ac59}.toReply[_ngcontent-%COMP%]{margin-bottom:.5rem}#text-box[_ngcontent-%COMP%]{min-height:4rem;font-size:1.5rem;border:none;overflow:auto;outline:none;box-shadow:none}[contenteditable=true][_ngcontent-%COMP%]:empty:before{content:attr(placeholder);pointer-events:none;color:var(--secondary-color);display:block}.selected-media[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:30px;margin-bottom:1rem}.media-count[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;padding:.5rem 1rem;border:0;border-radius:500px;text-align:center;display:inline;cursor:pointer;background-color:var(--primary-color);color:var(--text-color);margin-right:1rem}.media-count[_ngcontent-%COMP%]:hover:not(.current-selected-media){background-color:var(--hover-solid-color)}.count-container[_ngcontent-%COMP%]{margin:1rem 0;display:flex;flex-direction:row;align-items:center}.current-selected-media[_ngcontent-%COMP%]{background-color:var(--hover-empty-color)}.remove-bttn[_ngcontent-%COMP%]{margin-left:auto;padding:.2rem .5rem;font-size:1rem;border-color:orange}"]}),_),I=n("OUel"),N=function(){return{destination:1,parentIndex:0}};function z(e,t){1&e&&(a.Ob(0,"div"),a.Kb(1,"app-post-publish",5),a.Nb()),2&e&&(a.zb(1),a.fc("destinationConfig",a.gc(1,N)))}function S(e,t){if(1&e){var n=a.Pb();a.Ob(0,"div",6),a.Ob(1,"span",7),a.uc(2,"In order to post you need to be logged in!"),a.Nb(),a.Ob(3,"div",8),a.Ob(4,"button",9),a.Wb("click",(function(){return a.nc(n),a.ac().auth("Login")})),a.uc(5,"Login"),a.Nb(),a.uc(6," \xa0or\xa0 "),a.Ob(7,"button",9),a.Wb("click",(function(){return a.nc(n),a.ac().auth("Register")})),a.uc(8,"Register"),a.Nb(),a.Nb(),a.Nb()}}function L(e,t){if(1&e&&(a.Mb(0),a.Kb(1,"app-posts-list",10),a.Lb()),2&e){var n=a.ac();a.zb(1),a.fc("queryUrl",n.queryUrl)}}var R,j=((R=function(){function e(t,n,i,o,r){_classCallCheck(this,e),this.postsService=t,this.locationService=n,this.token=i,this.modalService=o,this.route=r,this.loading=!0}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this,t={explore:{query:"/posts?parent[size]=0&childLevel=0&[limit]=10",auth:!1},home:{query:"/posts/user",auth:!0}};this.isLogged$=this.token.user$.pipe(Object(r.a)((function(e){return!!e}))),this.route.params.subscribe((function(n){e.needsLogin=t[n.page].auth,e.queryUrl=t[n.page].query}))}},{key:"auth",value:function(e){this.modalService.open({type:"default",content:[{title:"Auth in order to post"},{module:"Auth",component:e,params:{navigateEnd:!1}}]},{action:"add",stack:[e]})}}]),e}()).\u0275fac=function(e){return new(e||R)(a.Jb(c.a),a.Jb(s.a),a.Jb(l.a),a.Jb(d.a),a.Jb(o.a))},R.\u0275cmp=a.Db({type:R,selectors:[["app-posts-page"]],decls:7,vars:7,consts:[[1,"container"],[4,"ngIf","ngIfElse"],["class","border auth-container"],["notLogged",""],[4,"ngIf"],[3,"destinationConfig"],[1,"notLogged"],[1,"auth-text"],[1,"bttn-group"],[1,"bttn","solid-bttn",3,"click"],[3,"queryUrl"]],template:function(e,t){if(1&e&&(a.Ob(0,"div",0),a.sc(1,z,2,2,"div",1),a.bc(2,"async"),a.sc(3,S,9,0,"ng-template",2,3,a.tc),a.sc(5,L,2,1,"ng-container",4),a.bc(6,"async"),a.Nb()),2&e){var n=a.kc(4);a.zb(1),a.fc("ngIf",a.cc(2,3,t.isLogged$))("ngIfElse",n),a.zb(4),a.fc("ngIf",!t.needsLogin&&null!==t.needsLogin||a.cc(6,5,t.isLogged$))}},directives:[i.k,w,I.a],pipes:[i.b],styles:[".notLogged[_ngcontent-%COMP%]{border-bottom:1.5px solid var(--primary-color);display:flex;flex-direction:column;justify-content:center;align-items:center;padding:2rem}.auth-text[_ngcontent-%COMP%]{font-size:1.2rem;padding-bottom:1rem;text-align:center}.bttn-group[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%}.bttn[_ngcontent-%COMP%]{flex:1;max-width:10rem;padding:.8rem 0}"]}),R),T=n("5+tZ"),U=n("SxV6"),A=function(e){return{i:e,type:"parent"}},D=function(){return{destination:0}},F=function(){return{owner:!1,thread:!0}};function K(e,t){if(1&e&&(a.Ob(0,"div"),a.Ob(1,"div"),a.Kb(2,"app-post",5),a.Nb(),a.Nb()),2&e){var n=t.$implicit,i=t.index;a.zb(2),a.fc("contextInfo",a.hc(4,A,i))("publishConfig",a.gc(6,D))("inputConfig",a.gc(7,F))("post",n)}}function J(e,t){if(1&e&&(a.Mb(0),a.sc(1,K,3,8,"div",4),a.Lb()),2&e){var n=a.ac();a.zb(1),a.fc("ngForOf",n.mainPost.parent)}}var B=function(){return{empty:!0,owner:!1,thread:!0}},W=function(){return{text:"Loading..."}};function E(e,t){if(1&e&&(a.Ob(0,"div"),a.Ob(1,"div"),a.Kb(2,"app-post",5),a.Nb(),a.Nb()),2&e){var n=t.index;a.zb(2),a.fc("contextInfo",a.hc(4,A,n))("publishConfig",a.gc(6,D))("inputConfig",a.gc(7,B))("post",a.gc(8,W))}}function $(e,t){if(1&e&&(a.Mb(0),a.sc(1,E,3,9,"div",4),a.Lb()),2&e){var n=a.ac();a.zb(1),a.fc("ngForOf",n.mainPost.parent)}}var X=function(){return{destination:1,parentIndex:0}},q=function(){return{owner:!1}};function V(e,t){if(1&e&&(a.Ob(0,"div"),a.Ob(1,"div",6),a.Kb(2,"app-post",7),a.Nb(),a.Nb()),2&e){var n=a.ac();a.zb(2),a.fc("publishConfig",a.gc(3,X))("inputConfig",a.gc(4,q))("post",n.mainPost)}}var H=function(e){return{i:e,type:"reply"}},Q=function(e){return{destination:0,parentIndex:e}},G=function(e,t){return{destination:2,parentIndex:e,childIndex:t}},Z=function(e){return{thread:e}};function Y(e,t){if(1&e&&(a.Ob(0,"div"),a.Ob(1,"div",11),a.Kb(2,"app-post",10),a.Nb(),a.Nb()),2&e){var n=t.$implicit,i=t.index,o=t.last,r=a.ac().index;a.zb(2),a.fc("contextInfo",a.hc(5,H,r))("publishConfig",a.hc(7,Q,r))("deleteConfig",a.ic(9,G,r,i))("inputConfig",a.hc(12,Z,!o))("post",n)}}var ee=function(e){return{i:e,type:"post"}},te=function(e,t){return{destination:2,parentIndex:e,childIndex:t,end:!0}},ne=function(e){return{destination:1,parentIndex:e}};function ie(e,t){if(1&e&&(a.Ob(0,"div",9),a.Ob(1,"div"),a.Kb(2,"app-post",10),a.Nb(),a.sc(3,Y,3,14,"div",4),a.Nb()),2&e){var n=t.$implicit,i=t.index;a.zb(2),a.fc("contextInfo",a.hc(6,ee,i))("publishConfig",a.ic(8,te,i,null==n.child?null:n.child.length))("deleteConfig",a.hc(11,ne,i))("inputConfig",a.hc(13,Z,0!==(null==n.child?null:n.child.length)))("post",n),a.zb(1),a.fc("ngForOf",n.child)}}function oe(e,t){1&e&&(a.Ob(0,"h3"),a.uc(1,"No replies yet"),a.Nb())}function re(e,t){if(1&e&&(a.Ob(0,"div"),a.sc(1,ie,4,15,"div",8),a.Ob(2,"div",3),a.sc(3,oe,2,0,"h3",2),a.Nb(),a.Nb()),2&e){var n=a.ac(2);a.zb(1),a.fc("ngForOf",n.repliesList),a.zb(2),a.fc("ngIf",!n.repliesList||0===(null==n.repliesList?null:n.repliesList.length))}}function ae(e,t){if(1&e&&(a.Ob(0,"div"),a.sc(1,re,4,2,"div",2),a.Nb()),2&e){var n=a.ac();a.zb(1),a.fc("ngIf",!n.loading)}}function ce(e,t){1&e&&(a.Ob(0,"h3"),a.uc(1,"Searching replies..."),a.Nb())}var se,le,de,ue=[{path:"post/:postId",component:(se=function(){function e(t,n,i){_classCallCheck(this,e),this.route=t,this.postsService=n,this.locationService=i,this.loading=!0}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.locationService.setStack(["Reply Page"]),this.sub2=this.postsService.posts$.subscribe((function(t){e.repliesList=t})),this.sub$=this.postsService.post$.subscribe((function(t){if(t){e.mainPost=t;var n=e.isPopulated(t.parent),i=e.isPopulated(t.child);n&&i&&e.repliesList||(e.loading=!0,e.postsService.getPostById(t._id).subscribe((function(t){e.mainPost=Object.assign({},e.mainPost,{parent:t.parent,child:t.child}),e.loading=!1})))}else e.loading=!0,e.route.params.pipe(Object(T.a)((function(t){return e.postsService.getPostById(t.postId)})),Object(U.a)()).subscribe((function(t){e.mainPost=Object.assign({},t),e.loading=!1}))}))}},{key:"ngOnChanges",value:function(e){console.warn(e)}},{key:"ngOnDestroy",value:function(){this.sub$.unsubscribe(),this.sub2.unsubscribe(),this.postsService.clearAll()}},{key:"isPopulated",value:function(e){return e&&e.every((function(e){return"string"!=typeof e}))||0===e.length}},{key:"checkParent",value:function(e){return(null==e?void 0:e.parent.length)>0&&"string"!=typeof(null==e?void 0:e.parent[0])}}]),e}(),se.\u0275fac=function(e){return new(e||se)(a.Jb(o.a),a.Jb(c.a),a.Jb(s.a))},se.\u0275cmp=a.Db({type:se,selectors:[["app-post-article"]],features:[a.xb],decls:8,vars:5,consts:[[1,"container"],[1,"post-list"],[4,"ngIf"],[2,"padding","2rem","text-align","center"],[4,"ngFor","ngForOf"],[3,"contextInfo","publishConfig","inputConfig","post"],[1,"main-post"],[3,"publishConfig","inputConfig","post"],["class","reply-container",4,"ngFor","ngForOf"],[1,"reply-container"],[3,"contextInfo","publishConfig","deleteConfig","inputConfig","post"],[1,"reply"]],template:function(e,t){1&e&&(a.Ob(0,"div",0),a.Ob(1,"div",1),a.sc(2,J,2,1,"ng-container",2),a.sc(3,$,2,1,"ng-container",2),a.sc(4,V,3,5,"div",2),a.sc(5,ae,2,1,"div",2),a.Ob(6,"div",3),a.sc(7,ce,2,0,"h3",2),a.Nb(),a.Nb(),a.Nb()),2&e&&(a.zb(2),a.fc("ngIf",t.checkParent(t.mainPost)),a.zb(1),a.fc("ngIf",t.mainPost&&!t.checkParent(t.mainPost)),a.zb(1),a.fc("ngIf",t.mainPost),a.zb(1),a.fc("ngIf",t.repliesList),a.zb(2),a.fc("ngIf",t.loading))},directives:[i.k,i.j,f.a],styles:[".main-post[_ngcontent-%COMP%]{border-bottom:15px solid var(--primary-color);background:var(--hover-color)}.container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column}.post-list[_ngcontent-%COMP%]{overflow:scroll;flex-grow:1}.post-list[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.reply-container[_ngcontent-%COMP%]{border-bottom:.15rem solid var(--primary-color)}"]}),se)},{path:":page",component:j},{path:"",redirectTo:"/explore",pathMatch:"full"}],pe=((le=function e(){_classCallCheck(this,e)}).\u0275mod=a.Hb({type:le}),le.\u0275inj=a.Gb({factory:function(e){return new(e||le)},imports:[[o.e.forChild(ue)],o.e]}),le),fe=n("ecLf"),be=n("iTUp"),ge=((de=function e(){_classCallCheck(this,e)}).components={PostComponent:f.a,PostPublishComponent:w,PostsListComponent:I.a},de.\u0275mod=a.Hb({type:de}),de.\u0275inj=a.Gb({factory:function(e){return new(e||de)},imports:[[i.c,pe,fe.a,be.a]]}),de)}}]);